mads 2.1.0 build 8 (23 Dec 19)
Source: D:\!Delphi\PAS6502\base\atari\s_vbxe\sdxld2.asm
     1 				// sdxld.com + s_vbxe.sys
     2
     3 				;ciov	= $e456
     4
     5 = 0086			errn	= $86
     6 = 0087			fnam	= $87
     7
     8 				;--------------------------
     9 					org $8000
    10 				;--------------------------
    11
    12 				s_vbxe
    13 FFFF> 8000-A7AA> FA FF + 	ins 's_vbxe.sys'
    14
    15
    16 A117			ciov	.local
    17 A117 E0 10			cpx #$10
    18 A119 F0 03			beq ok
    19
    20 A11B 4C 56 E4			jmp $e456
    21
    22 A11E BD 42 03		ok	lda $342,x
    23 A121 C9 03			cmp #3
    24 A123 F0 70			beq open
    25 A125 C9 07			cmp #7
    26 A127 F0 03			beq read
    27
    28 A129 A0 01			ldy #1
    29 A12B 60				rts
    30
    31 A12C BD 44 03		read	lda $344,x
    32 A12F 8D 56 A1			sta dst+1
    33 A132 BD 45 03			lda $345,x
    34 A135 8D 57 A1			sta dst+2
    35
    36 A138 BD 48 03			lda $348,x
    37 A13B 8D 93 A1			sta cnt
    38 A13E BD 49 03			lda $349,x
    39 A141 8D 94 A1			sta cnt+1
    40
    41 A144 AD 93 A1		move	lda cnt
    42 A147 0D 94 A1			ora cnt+1
    43 A14A D0 06			bne loa
    44
    45 A14C 20 87 A1			jsr src
    46
    47 A14F A0 01			ldy #1
    48 A151 60				rts
    49
    50 A152 20 87 A1		loa	jsr src
    51 A155 8D FF FF		dst	sta $ffff
    52
    53 A158 EE 56 A1 D0 03 EE + 	inw dst+1
    54
    55 A160 AD 93 A1 D0 03 CE + 	dew cnt
    56
    57 A16B AD 93 A1			lda cnt
    58 A16E 0D 94 A1			ora cnt+1
    59 A171 D0 DF			bne loa
    60
    61 A173 AD 89 A1 C9 A1 D0 + 	cpw src+1 #ciov
    62 A17F D0 03			bne skp
    63
    64 A181 A0 88			ldy #136
    65 A183 60				rts
    66
    67 A184 A0 01		skp	ldy #1
    68 A186 60				rts
    69
    70 A187 AD 00 80		src	lda s_vbxe
    71
    72 A18A EE 88 A1 D0 03 EE + 	inw src+1
    73 A192 60				rts
    74
    75 A193 00 00		cnt	dta a(0)
    76
    77 A195 A9 00 8D 88 A1 A9 + open	mwa #s_vbxe src+1
    78 A19F A0 01			ldy #1
    79 A1A1 60				rts
    80
    81 					.endl
    82
    83
    84 				;	.align
    85 A1A2			main
    86 A1A2 AD 00 07			lda $0700
    87 A1A5 C9 53			cmp #$53
    88 A1A7 D0 2E			bne E_8035
    89 A1A9 AD 01 07			lda $0701
    90 A1AC C9 40			cmp #$40
    91 A1AE 90 27			bcc E_8035
    92
    93 A1B0 20 0A A6			jsr printF
    94
    95 A1B3 9B				dta $9B
    96 A1B4 54 68 69 73 20 44 + 	dta c'This DOS does not need SDXLD.COM',$9b,$00
    97
    98 A1D6 60				rts
    99
   100 A1D7 78			E_8035	sei
   101 A1D8 EE 0E D4			inc $d40e
   102
   103 A1DB A2 00			ldx #0
   104 A1DD B5 00 9D AB A7 E8 + 	mva:rne 0,x zpbuf,x+
   105
   106 A1E5			start
   107 A1E5 A9 00			lda #$00
   108 A1E7 A2 3F			ldx #$3F
   109 A1E9 9D 2B A9		E_8039	sta E_870F,x
   110 A1EC CA				dex
   111 A1ED 10 FA			bpl E_8039
   112 A1EF A2 01			ldx #$01
   113 A1F1 BD E7 02		E_8041	lda $02E7,x
   114 A1F4 9D 4D A9			sta E_8731,x
   115 A1F7 CA				dex
   116 A1F8 10 F7			bpl E_8041
   117 				/*
   118 					lda <vbxecmd
   119 					sta fnam
   120 					lda >vbxecmd
   121 					sta fnam+1
   122 					jsr OpenFile
   123 					bmi E_809B
   124
   125 					lda <buffer
   126 					sta $0344,x
   127 					lda >buffer
   128 					sta $0345,x
   129 					lda #$80
   130 					sta $0348,x
   131 					lda #$00
   132 					sta $0349,x
   133 					lda #$07
   134 					jsr IoCmd
   135
   136 					lda $0344,x
   137 					clc
   138 					adc $0348,x
   139 					sta $0089
   140 					lda $0345,x
   141 					adc $0349,x
   142 					sta $008A
   143 					ldy #$00
   144 					lda #$9B
   145 					sta ($0089),y
   146 					jsr CloseFile
   147
   148 					ldx #$FF
   149 				E_808C	inx
   150 					lda buffer,x
   151 					cmp #$9B
   152 					beq E_8098
   153 					cmp #$20
   154 					beq E_808C
   155
   156 				E_8098	stx E_8734
   157 				E_809B	ldx #$00
   158 					lda $0342,x
   159 					cmp #$05
   160 					bne E_80E0
   161 					lda $0344,x
   162 					sta $0089
   163 					lda $0345,x
   164 					sta $008A
   165 					ldy #$00
   166 				E_80B0	lda ($0089),y
   167 					cmp #$20
   168 					beq E_80C1
   169 					cmp #$2C
   170 					beq E_80C1
   171 					cmp #$9B
   172 					beq E_80E0
   173 					iny
   174 					bne E_80B0
   175 				E_80C1	iny
   176 					lda ($0089),y
   177 					cmp #$20
   178 					beq E_80C1
   179 					cmp #$9B
   180 					beq E_80E0
   181 					ldx #$00
   182 				E_80CE	lda ($0089),y
   183 					sta buffer,x
   184 					inx
   185 					cmp #$9B
   186 					beq E_80DB
   187 					iny
   188 					bpl E_80CE
   189 				E_80DB	lda #$00
   190 					sta buffer,x
   191 				*/
   191
   192 A1FA A9 0E		E_80E0	lda <vbxesys
   193 A1FC 85 87			sta fnam
   194 A1FE A9 A4			lda >vbxesys
   195 A200 85 88			sta fnam+1
   196 A202 20 1C A4			jsr OpenFile
   197 A205 30 28			bmi E_8115
   198
   199 A207 A2 10		E_80ED	ldx #$10
   200 A209 A9 00			lda #$00
   201 A20B A0 02			ldy #$02
   202 A20D 20 43 A4			jsr E_8337
   203
   204 A210 30 1D			bmi E_8115
   205 A212 A0 98			ldy #$98
   206 A214 A2 10			ldx #$10
   207 A216 AD 5C A9			lda header+1
   208 A219 C9 FF			cmp >$FFFA
   209 A21B D0 12			bne E_8115
   210 A21D AD 5B A9			lda header
   211 A220 E9 FA			sbc <$FFFA
   212 A222 30 0B			bmi E_8115
   213 A224 0A				asl @
   214 A225 A8				tay
   215 A226 B9 FF A5			lda E_84E2+1,y
   216 A229 48				pha
   217 A22A B9 FE A5			lda E_84E2,y
   218 A22D 48				pha
   219 A22E 60				rts
   220
   221 A22F 4C 5F A4		E_8115	jmp E_8353
   222
   223 A232 20 E1 A3		Read	jsr E_82C7
   224
   225 A235 30 6F			bmi E_818C
   226 A237 A9 02			lda #$02
   227 A239 A0 0A			ldy #$0A
   228 A23B 20 43 A4			jsr E_8337
   229
   230 A23E 30 66			bmi E_818C
   231 A240 4C 07 A2			jmp E_80ED
   232
   233 A243 A9 51		Close	lda <E_8735
   234 A245 9D 44 03			sta $0344,x
   235 A248 A9 A9			lda >E_8735
   236 A24A 9D 45 03			sta $0345,x
   237 A24D A9 08			lda #$08
   238 A24F 9D 48 03			sta $0348,x
   239 A252 A9 00			lda #$00
   240 A254 9D 49 03			sta $0349,x
   241 A257 A9 07			lda #$07
   242 A259 20 3D A4			jsr IOCmd
   243
   244 A25C 30 48			bmi E_818C
   245
   246 A25E A9 E7			lda <symbols
   247 A260 85 80			sta $0080
   248 A262 A9 A4			lda >symbols
   249 A264 85 81			sta $0081
   250
   251 A266 A0 00		E_814C	ldy #$00
   252 A268 B1 80		E_814E	lda ($0080),y
   253 A26A F0 17			beq E_8169
   254 A26C D9 51 A9			cmp E_8735,y
   255 A26F D0 38			bne E_818F
   256 A271 C8				iny
   257 A272 C0 08			cpy #$08
   258 A274 90 F2			bcc E_814E
   259 A276 B1 80			lda ($0080),y
   260 A278 8D 2B A9			sta E_870F
   261 A27B C8				iny
   262 A27C B1 80			lda ($0080),y
   263 A27E 8D 2C A9			sta E_8710
   264 A281 B0 38			bcs E_81A1
   265 A283 A9 00		E_8169	lda #$00
   266 A285 8D 59 A9			sta E_873D
   267
   268 A288 20 0A A6			jsr printF
   269
   270 A28B 53 79 6D 62 6F 6C + 	dta c'Symbol %s not defined',$9B,$00
   271 A2A2 51 A9			dta a(E_8735)
   272
   273 A2A4 A0 9A			ldy #$9A
   274 A2A6 4C 5F A4		E_818C	jmp E_8353
   275
   276 A2A9 A5 80		E_818F	lda $0080
   277 A2AB 18				clc
   278 A2AC 69 0A			adc #$0A
   279 A2AE 85 80			sta $0080
   280 A2B0 90 B4			bcc E_814C
   281 A2B2 E6 81			inc $0081
   282 A2B4 D0 B0			bne E_814C
   283
   284 A2B6 20 E1 A3		Write	jsr E_82C7
   285
   286 A2B9 30 EB			bmi E_818C
   287 A2BB A9 02		E_81A1	lda #$02
   288 A2BD A0 02			ldy #$02
   289 A2BF 20 43 A4			jsr E_8337
   290
   291 A2C2 30 E2			bmi E_818C
   292 A2C4 20 FD A3		E_81AA	jsr E_82E3
   293
   294 A2C7 30 DD			bmi E_818C
   295 A2C9 C9 FE			cmp #$FE
   296 A2CB F0 2A			beq E_81DD
   297 A2CD B0 1A			bcs E_81CF
   298 A2CF C9 FC			cmp #$FC
   299 A2D1 F0 4B			beq E_8204
   300 A2D3 B0 35			bcs E_81F0
   301 A2D5 A8				tay
   302 A2D6 B1 82		E_81BC	lda ($0082),y
   303 A2D8 18				clc
   304 A2D9 6D 2B A9			adc E_870F
   305 A2DC 91 82			sta ($0082),y
   306 A2DE C8				iny
   307 A2DF B1 82			lda ($0082),y
   308 A2E1 6D 2C A9			adc E_8710
   309 A2E4 91 82			sta ($0082),y
   310 A2E6 88				dey
   311 A2E7 98				tya
   312 A2E8 2C				dta $2C
   313 A2E9 A9 FA		E_81CF	lda #$FA
   314 A2EB 18				clc
   315 A2EC 65 82			adc $0082
   316 A2EE 85 82			sta $0082
   317 A2F0 90 D2			bcc E_81AA
   318 A2F2 E6 83			inc $0083
   319 A2F4 4C C4 A2			jmp E_81AA
   320
   321 A2F7 20 FD A3		E_81DD	jsr E_82E3
   322
   323 A2FA 30 AA			bmi E_818C
   324 A2FC AA				tax
   325 A2FD BD 2D A9			lda E_8711,x
   326 A300 85 82			sta $0082
   327 A302 BD 35 A9			lda E_8719,x
   328 A305 85 83			sta $0083
   329 A307 4C C4 A2			jmp E_81AA
   330
   331 A30A 20 FD A3		E_81F0	jsr E_82E3
   332
   333 A30D 30 7C			bmi E_8271
   334 A30F 85 82			sta $0082
   335 A311 20 FD A3			jsr E_82E3
   336
   337 A314 30 75			bmi E_8271
   338 A316 85 83			sta $0083
   339 A318 A0 00			ldy #$00
   340 A31A 98				tya
   341 A31B 4C D6 A2			jmp E_81BC
   342
   343 A31E 4C 07 A2		E_8204	jmp E_80ED
   344
   345 A321 20 FD A3		Status	jsr E_82E3
   346
   347 A324 30 65			bmi E_8271
   348 A326 85 84			sta $0084
   349 A328 20 FD A3			jsr E_82E3
   350
   351 A32B 30 5E			bmi E_8271
   352 A32D 85 85			sta $0085
   353 A32F 20 FD A3			jsr E_82E3
   354
   355 A332 30 57			bmi E_8271
   356 A334 A4 84			ldy $0084
   357 A336 99 3D A9			sta E_8721,y
   358 A339 20 FD A3			jsr E_82E3
   359
   360 A33C 30 4D			bmi E_8271
   361 A33E A4 84			ldy $0084
   362 A340 99 45 A9			sta E_8729,y
   363 A343 A9 02			lda #$02
   364 A345 A0 02			ldy #$02
   365 A347 20 43 A4			jsr E_8337
   366
   367 A34A 30 3F			bmi E_8271
   368 A34C A5 85			lda $0085
   369 A34E 30 21			bmi E_8257
   370 A350 A2 10			ldx #$10
   371 A352 AD 5D A9			lda loaadr
   372 A355 9D 48 03			sta $0348,x
   373 A358 AD 5E A9			lda loaadr+1
   374 A35B 9D 49 03			sta $0349,x
   375 A35E AD 4D A9			lda E_8731
   376 A361 9D 44 03			sta $0344,x
   377 A364 AD 4E A9			lda E_8732
   378 A367 9D 45 03			sta $0345,x
   379 A36A A9 07			lda #$07
   380 A36C 20 3D A4			jsr IOCmd
   381
   382 A36F 30 1A			bmi E_8271
   383 A371 A4 84		E_8257	ldy $0084
   384 A373 AD 4D A9			lda E_8731
   385 A376 99 2D A9			sta E_8711,y
   386 A379 AD 4E A9			lda E_8732
   387 A37C 99 35 A9			sta E_8719,y
   388 A37F AD 5D A9			lda loaadr
   389 A382 AE 5E A9			ldx loaadr+1
   390 A385 20 E8 A5			jsr E_84CC
   391
   392 A388 4C 07 A2			jmp E_80ED
   393
   394 A38B 4C 5F A4		E_8271	jmp E_8353
   395
   396 A38E A9 02		Open	lda #$02
   397 A390 A0 04			ldy #$04
   398 A392 20 43 A4			jsr E_8337
   399
   400 A395 30 F4			bmi E_8271
   401 A397 AD A8 A4			lda E_839A+2
   402 A39A C9 A4			cmp >E_83AD
   403 A39C D0 12			bne E_8296
   404 A39E AD A7 A4			lda E_839A+1
   405 A3A1 C9 B9			cmp <E_83AD
   406 A3A3 D0 0B			bne E_8296
   407 A3A5 A0 01			ldy #$01
   408 A3A7 B9 5D A9		E_828D	lda loaadr,y
   409 A3AA 99 A7 A4			sta E_839A+1,y
   410 A3AD 88				dey
   411 A3AE 10 F7			bpl E_828D
   412 A3B0 AD 5F A9		E_8296	lda endadr
   413 A3B3 38				sec
   414 A3B4 ED 5D A9			sbc loaadr
   415 A3B7 9D 48 03			sta $0348,x
   416 A3BA AD 60 A9			lda endadr+1
   417 A3BD ED 5E A9			sbc loaadr+1
   418 A3C0 9D 49 03			sta $0349,x
   419 A3C3 FE 48 03			inc $0348,x
   420 A3C6 D0 03			bne E_82B1
   421 A3C8 FE 49 03			inc $0349,x
   422 A3CB AD 5D A9		E_82B1	lda loaadr
   423 A3CE 9D 44 03			sta $0344,x
   424 A3D1 AD 5E A9			lda loaadr+1
   425 A3D4 9D 45 03			sta $0345,x
   426 A3D7 A9 07			lda #$07
   427 A3D9 20 3D A4			jsr IOCmd
   428
   429 A3DC 30 AD			bmi E_8271
   430 A3DE 4C 07 A2			jmp E_80ED
   431
   432 A3E1 20 FD A3		E_82C7	jsr E_82E3
   433
   434 A3E4 30 14			bmi E_82E0
   435 A3E6 AA				tax
   436 A3E7 38				sec
   437 A3E8 BD 2D A9			lda E_8711,x
   438 A3EB FD 3D A9			sbc E_8721,x
   439 A3EE 8D 2B A9			sta E_870F
   440 A3F1 BD 35 A9			lda E_8719,x
   441 A3F4 FD 45 A9			sbc E_8729,x
   442 A3F7 8D 2C A9			sta E_8710
   443 A3FA C0 00		E_82E0	cpy #$00
   444 A3FC 60				rts
   445
   446 A3FD 8A			E_82E3	txa
   447 A3FE 48				pha
   448 A3FF A9 02			lda #$02
   449 A401 A0 01			ldy #$01
   450 A403 20 43 A4			jsr E_8337
   451
   452 A406 68				pla
   453 A407 AA				tax
   454 A408 AD 5D A9			lda loaadr
   455 A40B C0 00			cpy #$00
   456 A40D 60				rts
   457
   458 A40E 44 3A 53 5F 56 42 + vbxesys	dta c'D:S_VBXE.SYS',$9B,$00
   459
   460 				//vbxecmd	dta c'D:S_VBXE.CMD',$9B,$00
   461
   462 A41C			OpenFile
   463 A41C A2 10			ldx #$10
   464 A41E 20 39 A4			jsr CloseFile
   465
   466 A421 A5 87			lda fnam
   467 A423 9D 44 03			sta $0344,x
   468 A426 A5 88			lda fnam+1
   469 A428 9D 45 03			sta $0345,x
   470 A42B A9 04			lda #$04
   471 A42D 9D 4A 03			sta $034A,x
   472 A430 A9 00			lda #$00
   473 A432 9D 4B 03			sta $034B,x
   474 A435 A9 03			lda #$03
   475 A437 D0 04			bne IOCmd
   476
   477 A439			CloseFile
   478 A439 A2 10			ldx #$10
   479 A43B A9 0C			lda #$0C
   480 A43D 9D 42 03		IOCmd	sta $0342,x
   481 A440 4C 17 A1			jmp ciov
   482
   483 A443 A2 10		E_8337	ldx #$10
   484 A445 18				clc
   485 A446 69 5B			adc <header
   486 A448 9D 44 03			sta $0344,x
   487 A44B A9 00			lda #$00
   488 A44D 69 A9			adc >header
   489 A44F 9D 45 03			sta $0345,x
   490 A452 98				tya
   491 A453 9D 48 03			sta $0348,x
   492 A456 A9 00			lda #$00
   493 A458 9D 49 03			sta $0349,x
   494 A45B A9 07			lda #$07
   495 A45D D0 DE			bne IOCmd
   496
   497 A45F 84 86		E_8353	sty errn
   498 A461 20 39 A4			jsr CloseFile
   499
   500 A464 A4 86			ldy errn
   501 A466 C0 88			cpy #$88
   502 A468 D0 5E			bne E_83AE
   503 A46A A2 1D			ldx #$1D
   504 A46C A9 00			lda #$00
   505 A46E 9D 5B A9		E_8362	sta header,x
   506 A471 CA				dex
   507 A472 10 FA			bpl E_8362
   508 A474 A9 10			lda #$10
   509 A476 8D 78 A9			sta temp+23
   510 A479 A9 83			lda #$83
   511 A47B 8D 66 A9			sta temp+5
   512 A47E A2 00			ldx #$00
   513 A480 BD 00 04		E_8374	lda $0400,x
   514 A483 C9 20			cmp #$20
   515 A485 F0 04			beq E_837F
   516 A487 C9 4C			cmp #$4C
   517 A489 D0 18			bne E_8397
   518 A48B BD 01 04		E_837F	lda $0401,x
   519 A48E C9 EB			cmp #$EB
   520 A490 D0 11			bne E_8397
   521 A492 BD 02 04			lda $0402,x
   522 A495 C9 07			cmp #$07
   523 A497 D0 0A			bne E_8397
   524 A499 A9 4C			lda <E_8430
   525 A49B 9D 01 04			sta $0401,x
   526 A49E A9 A5			lda >E_8430
   527 A4A0 9D 02 04			sta $0402,x
   528 A4A3 E8			E_8397	inx
   529 A4A4 D0 DA			bne E_8374
   530 A4A6 20 B9 A4		E_839A	jsr E_83AD
   531
   532 A4A9 2C 4F A9			bit E_8733
   533 A4AC 10 0B			bpl E_83AD
   534 A4AE A2 01			ldx #$01
   535 A4B0 BD 4D A9		E_83A4	lda E_8731,x
   536 A4B3 9D E7 02			sta $02E7,x
   537 A4B6 CA				dex
   538 A4B7 10 F7			bpl E_83A4
   539
   540 A4B9			E_83AD
   541
   542 A4B9 A2 00			ldx #0
   543 A4BB BD AB A7 95 00 E8 + 	mva:rne zpbuf,x 0,x+
   544
   545 A4C3 CE 0E D4			dec $d40e
   546 A4C6 58				cli
   547
   548 A4C7 60				rts		; end
   549
   550 A4C8 20 0A A6		E_83AE	jsr printF
   551
   552 A4CB 45 72 72 6F 72 20 + 	dta c'Error %b loading %p',$9B,$00
   553 A4E0 86 00			dta a(errn)
   554 A4E2 87 00			dta a(fnam)
   555
   556 A4E4 4C B9 A4			jmp E_83AD
   557 				;	rts
   558
   559 A4E7 53 5F 41 44 44 20 + symbols	dta c'S_ADD   ',a(_rts)
   560 A4F1 45 58 54 45 4E 44 + 	dta c'EXTENDED',a(Break)
   561 A4FB 53 59 4D 42 4F 4C + 	dta c'SYMBOL  ',a(E_8735)
   562 A505 43 4F 4D 54 41 42 + 	dta c'COMTAB  ',a(header)
   563 A50F 50 52 49 4E 54 46 + 	dta c'PRINTF  ',a(printF)
   564 A519 53 5F 41 44 44 49 + 	dta c'S_ADDIZ ',a(s_addiz)
   565 A523 55 5F 47 45 54 4E + 	dta c'U_GETNUM',a(U_GETNUM)
   566 A52D 55 5F 53 4C 41 53 + 	dta c'U_SLASH ',a(U_SLASH)
   567 A537 49 4E 53 54 41 4C + 	dta c'INSTALL ',a(E_8733)
   568 A541 54 5F 20 20 20 20 + 	dta c'T_      ',a(header)
   569 A54B 00				dta $00
   570
   571 A54C A9 00		E_8430	lda #$00
   572 A54E 60				rts
   573
   574 A54F			U_GETNUM
   575 A54F A9 AB			lda <buffer
   576 A551 18				clc
   577 A552 6D 50 A9			adc E_8734
   578 A555 48				pha
   579 A556 A9 A8			lda >buffer
   580 A558 69 00			adc #$00
   581 A55A AA				tax
   582 A55B 68				pla
   583 A55C 20 19 A7			jsr E_85FD
   584
   585 A55F 08				php
   586 A560 48				pha
   587 A561 98				tya
   588 A562 48				pha
   589 A563 AC 50 A9			ldy E_8734
   590 A566 B9 AB A8		E_844A	lda buffer,y
   591 A569 C9 9B			cmp #$9B
   592 A56B F0 13			beq E_8464
   593 A56D C9 2F			cmp #$2F
   594 A56F F0 0F			beq E_8464
   595 A571 C8				iny
   596 A572 30 0C			bmi E_8464
   597 A574 C9 20			cmp #$20
   598 A576 D0 EE			bne E_844A
   599 A578 C8			E_845C	iny
   600 A579 B9 AB A8			lda buffer,y
   601 A57C C9 20			cmp #$20
   602 A57E F0 F8			beq E_845C
   603 A580 8C 50 A9		E_8464	sty E_8734
   604 A583 68				pla
   605 A584 A8				tay
   606 A585 68				pla
   607 A586 28				plp
   608
   609 A587 85 80		U_SLASH	sta $0080
   610 A589 86 81			stx $0081
   611 A58B 84 89			sty $0089
   612 A58D 88			E_8471	dey
   613 A58E 88				dey
   614 A58F 30 06			bmi E_847B
   615 A591 A9 00			lda #$00
   616 A593 91 80			sta ($0080),y
   617 A595 F0 F6			beq E_8471
   618 A597 A0 01		E_847B	ldy #$01
   619 A599 AE 50 A9			ldx E_8734
   620 A59C BD AB A8			lda buffer,x
   621 A59F C9 2F			cmp #$2F
   622 A5A1 D0 17			bne E_849E
   623 A5A3 A0 01		E_8487	ldy #$01
   624 A5A5 E8				inx
   625 A5A6 BD AB A8		E_848A	lda buffer,x
   626 A5A9 D1 80			cmp ($0080),y
   627 A5AB D0 07			bne E_8498
   628 A5AD 88				dey
   629 A5AE A9 FF			lda #$FF
   630 A5B0 91 80			sta ($0080),y
   631 A5B2 D0 EF			bne E_8487
   632 A5B4 C8			E_8498	iny
   633 A5B5 C8				iny
   634 A5B6 C4 89			cpy $0089
   635 A5B8 90 EC			bcc E_848A
   636 A5BA 8E 50 A9		E_849E	stx E_8734
   637 A5BD 60				rts
   638
   639 A5BE 8D F9 A5		s_addiz	sta E_84DC+1
   640 A5C1 8C FA A5			sty E_84DC+2
   641 A5C4 A5 0C			lda $000C
   642 A5C6 8D FC A5			sta E_84DF+1
   643 A5C9 A5 0D			lda $000D
   644 A5CB 8D FD A5			sta E_84DF+2
   645 A5CE A2 01			ldx #$01
   646 A5D0 BD 4D A9		E_84B4	lda E_8731,x
   647 A5D3 95 0C			sta $000C,x
   648 A5D5 95 80			sta $0080,x
   649 A5D7 CA				dex
   650 A5D8 10 F6			bpl E_84B4
   651 A5DA A0 05			ldy #$05
   652 A5DC B9 F8 A5		E_84C0	lda E_84DC,y
   653 A5DF 91 80			sta ($0080),y
   654 A5E1 88				dey
   655 A5E2 10 F8			bpl E_84C0
   656 A5E4 A9 06			lda #$06
   657 A5E6 A2 00			ldx #$00
   658 A5E8 18			E_84CC	clc
   659 A5E9 6D 4D A9			adc E_8731
   660 A5EC 8D 4D A9			sta E_8731
   661 A5EF 8A				txa
   662 A5F0 6D 4E A9			adc E_8732
   663 A5F3 8D 4E A9			sta E_8732
   664 A5F6 18				clc
   665 A5F7 60			_rts	rts
   666
   667 A5F8 20 00 00		E_84DC	jsr $0000
   668
   669 A5FB 4C 00 00		E_84DF	jmp $0000
   670
   671 				; http://tajemnice.atari8.info/8_91/8_91_dosy.html
   672 				; Tablica sterownika (ang. handler) zawiera szereg wektorów o okreœlonym znaczeniu.
   673 				; Ich kolejnoœæ jest nastêpuj¹ca:
   674 				;	OPEN (wektor otwarcia pliku)
   675 				;	CLOSE (wektor zamkniêcia pliku)
   676 				;	GET BYTE (wektor pobrania bajtu z urz¹dzenia Ÿród³owego)
   677 				;	PUT BYTE (wektor wys³ania bajtu do peryferia)
   678 				;	GET STATUS (wektor pobrania statusu)
   679 				;	SPECIAL (wektor specjalny).
   680
   681 A5FE 8D A3 42 A2 31 A2 + E_84E2	dta a(Open-1, Close-1, Read-1, Write-1, Status-1, Open-1)
   682
   683 A60A 68			printF	pla
   684 A60B 85 32			sta $0032
   685 A60D 68				pla
   686 A60E 85 33			sta $0033
   687 A610 A0 00			ldy #$00
   688 A612 C8			E_84F6	iny
   689 A613 B1 32			lda ($0032),y
   690 A615 D0 FB			bne E_84F6
   691 A617 38				sec
   692 A618 98				tya
   693 A619 65 32			adc $0032
   694 A61B 85 34			sta $0034
   695 A61D A9 00			lda #$00
   696 A61F 65 33			adc $0033
   697 A621 85 35			sta $0035
   698 A623 A0 01			ldy #$01
   699 A625 B1 32		E_8509	lda ($0032),y
   700 A627 F0 16			beq E_8523
   701 A629 C8				iny
   702 A62A 84 15			sty $0015
   703 A62C A2 00			ldx #$00
   704 A62E 86 3A			stx $003A
   705 A630 0A				asl @
   706 A631 66 3A			ror $003A
   707 A633 4A				lsr @
   708 A634 C9 25			cmp #$25
   709 A636 F0 0B			beq E_8527
   710 A638 20 0A A7		E_851C	jsr E_85EE
   711
   712 A63B A4 15		E_851F	ldy $0015
   713 A63D D0 E6			bne E_8509
   714 A63F B8			E_8523	clv
   715 A640 6C 34 00			jmp ($0034)
   716
   717 A643 B1 32		E_8527	lda ($0032),y
   718 A645 C9 25			cmp #$25
   719 A647 F0 21			beq E_854E
   720 A649 29 5F			and #$5F
   721 A64B C9 58			cmp #$58
   722 A64D F0 21			beq E_8554
   723 A64F C9 42			cmp #$42
   724 A651 F0 3C			beq E_8573
   725 A653 C9 44			cmp #$44
   726 A655 F0 33			beq E_856E
   727 A657 C9 43			cmp #$43
   728 A659 F0 53			beq E_8592
   729 A65B C9 53			cmp #$53
   730 A65D F0 58			beq E_859B
   731 A65F C9 50			cmp #$50
   732 A661 F0 69			beq E_85B0
   733 A663 C9 46			cmp #$46
   734 A665 F0 16			beq E_8561
   735 A667 A9 25			lda #$25
   736 A669 2C				dta $2C
   737 A66A E6 15		E_854E	inc $0015
   738 A66C D0 CA			bne E_851C
   739 A66E F0 CB		E_8552	beq E_851F
   740 A670 20 D8 A6		E_8554	jsr E_85BC
   741
   742 A673 20 F9 A6			jsr E_85DD
   743
   744 A676 A5 D4			lda $00D4
   745 A678 20 F9 A6			jsr E_85DD
   746
   747 A67B D0 BE			bne E_851F
   748 A67D 20 E1 A6		E_8561	jsr E_85C5
   749
   750 A680 A6 36			ldx $0036
   751 A682 A4 37			ldy $0037
   752 A684 20 89 DD			jsr $DD89
   753
   754 A687 B8				clv
   755 A688 50 0D			bvc E_857B
   756 A68A 20 D8 A6		E_856E	jsr E_85BC
   757
   758 A68D B0 05			bcs E_8578
   759 A68F 20 E1 A6		E_8573	jsr E_85C5
   760
   761 A692 84 D5			sty $00D5
   762 A694 20 AA D9		E_8578	jsr $D9AA
   763
   764 A697 20 E6 D8		E_857B	jsr $D8E6
   765
   766 A69A A0 00			ldy #$00
   767 A69C B1 F3		E_8580	lda ($00F3),y
   768 A69E 08				php
   769 A69F 29 7F			and #$7F
   770 A6A1 84 39			sty $0039
   771 A6A3 20 0A A7			jsr E_85EE
   772
   773 A6A6 A4 39			ldy $0039
   774 A6A8 C8				iny
   775 A6A9 28				plp
   776 A6AA 10 F0			bpl E_8580
   777 A6AC 30 8D			bmi E_851F
   778 A6AE 20 E1 A6		E_8592	jsr E_85C5
   779
   780 A6B1 20 0A A7			jsr E_85EE
   781
   782 A6B4 4C 3B A6			jmp E_851F
   783
   784 A6B7 20 E1 A6		E_859B	jsr E_85C5
   785
   786 A6BA B1 36		E_859E	lda ($0036),y
   787 A6BC F0 B0			beq E_8552
   788 A6BE C9 9B			cmp #$9B
   789 A6C0 F0 AC			beq E_8552
   790 A6C2 84 38			sty $0038
   791 A6C4 20 0A A7			jsr E_85EE
   792
   793 A6C7 A4 38			ldy $0038
   794 A6C9 C8				iny
   795 A6CA D0 EE			bne E_859E
   796 A6CC 20 D8 A6		E_85B0	jsr E_85BC
   797
   798 A6CF 85 37			sta $0037
   799 A6D1 A5 D4			lda $00D4
   800 A6D3 85 36			sta $0036
   801 A6D5 88				dey
   802 A6D6 F0 E2			beq E_859E
   803 A6D8 20 E1 A6		E_85BC	jsr E_85C5
   804
   805 A6DB C8				iny
   806 A6DC B1 36			lda ($0036),y
   807 A6DE 85 D5			sta $00D5
   808 A6E0 60				rts
   809
   810 A6E1 E6 15		E_85C5	inc $0015
   811 A6E3 A2 FE			ldx #$FE
   812 A6E5 A0 00			ldy #$00
   813 A6E7 B1 34		E_85CB	lda ($0034),y
   814 A6E9 95 38			sta $0038,x
   815 A6EB E6 34			inc $0034
   816 A6ED D0 02			bne E_85D5
   817 A6EF E6 35			inc $0035
   818 A6F1 E8			E_85D5	inx
   819 A6F2 30 F3			bmi E_85CB
   820 A6F4 B1 36			lda ($0036),y
   821 A6F6 85 D4			sta $00D4
   822 A6F8 60				rts
   823
   824 A6F9 48			E_85DD	pha
   825 A6FA 4A 4A 4A 4A			:4	lsr @
   826 A6FE 20 04 A7			jsr E_85E8
   827
   828 A701 68				pla
   829 A702 29 0F			and #$0F
   830 A704 C9 0A		E_85E8	cmp #$0A
   831 A706 F8				sed
   832 A707 69 30			adc #$30
   833 A709 D8				cld
   834 A70A 05 3A		E_85EE	ora $003A
   835 A70C A8				tay
   836 A70D AD 47 03			lda $0347
   837 A710 48				pha
   838 A711 AD 46 03			lda $0346
   839 A714 48				pha
   840 A715 98				tya
   841 A716 A2 00			ldx #$00
   842 A718 60				rts
   843
   844 A719 85 15		E_85FD	sta $0015
   845 A71B 86 16			stx $0016
   846 A71D A0 00			ldy #$00
   847 A71F 84 32			sty $0032
   848 A721 84 33			sty $0033
   849 A723 84 34			sty $0034
   850 A725 B1 15			lda ($0015),y
   851 A727 C9 24			cmp #$24
   852 A729 D0 2C			bne E_863B
   853 A72B C8			E_860F	iny
   854 A72C B1 15			lda ($0015),y
   855 A72E C9 30			cmp #$30
   856 A730 90 64			bcc E_867A
   857 A732 C9 3A			cmp #$3A
   858 A734 90 0D			bcc E_8627
   859 A736 29 DF			and #$DF
   860 A738 C9 41			cmp #$41
   861 A73A 90 5A			bcc E_867A
   862 A73C C9 47			cmp #$47
   863 A73E B0 56			bcs E_867A
   864 A740 38				sec
   865 A741 E9 37			sbc #$37
   866 A743 29 0F		E_8627	and #$0F
   867 A745 A2 04			ldx #$04
   868 A747 06 32		E_862B	asl $0032
   869 A749 26 33			rol $0033
   870 A74B 26 34			rol $0034
   871 A74D CA				dex
   872 A74E D0 F7			bne E_862B
   873 A750 05 32			ora $0032
   874 A752 85 32			sta $0032
   875 A754 4C 2B A7			jmp E_860F
   876
   877 A757 B1 15		E_863B	lda ($0015),y
   878 A759 20 A1 A7			jsr E_8685
   879
   880 A75C B0 39			bcs E_867B
   881 A75E 29 0F			and #$0F
   882 A760 48				pha
   883 A761 06 32			asl $0032
   884 A763 26 33			rol $0033
   885 A765 26 34			rol $0034
   886 A767 A5 33			lda $0033
   887 A769 85 35			sta $0035
   888 A76B A5 34			lda $0034
   889 A76D 85 36			sta $0036
   890 A76F A5 32			lda $0032
   891 A771 0A				asl @
   892 A772 26 35			rol $0035
   893 A774 26 36			rol $0036
   894 A776 0A				asl @
   895 A777 26 35			rol $0035
   896 A779 26 36			rol $0036
   897 A77B A2 FD			ldx #$FD
   898 A77D 75 35		E_8661	adc $0035,x
   899 A77F 95 35			sta $0035,x
   900 A781 B5 38			lda $0038,x
   901 A783 E8				inx
   902 A784 D0 F7			bne E_8661
   903 A786 68				pla
   904 A787 65 32			adc $0032
   905 A789 85 32			sta $0032
   906 A78B 90 06			bcc E_8677
   907 A78D E6 33			inc $0033
   908 A78F D0 02			bne E_8677
   909 A791 E6 34			inc $0034
   910 A793 C8			E_8677	iny
   911 A794 D0 C1			bne E_863B
   912 A796 88			E_867A	dey
   913 A797 98			E_867B	tya
   914 A798 08				php
   915 A799 A5 32			lda $0032
   916 A79B A6 33			ldx $0033
   917 A79D A4 34			ldy $0034
   918 A79F 28				plp
   919 A7A0 60				rts
   920
   921 A7A1 C9 30		E_8685	cmp #$30
   922 A7A3 90 03			bcc E_868C
   923 A7A5 C9 3A			cmp #$3A
   924 A7A7 24				dta $24
   925 A7A8 38			E_868C	sec
   926 A7A9 60				rts
   927
   928 A7AA 00			Break	brk
   929
   930 = A7AB			zpbuf	.ds 256
   931
   932 = A8AB			buffer	.ds 128
   933
   934 = A92B			E_870F	.ds 1
   935 = A92C			E_8710	.ds 1
   936 = A92D			E_8711	.ds 8
   937 = A935			E_8719	.ds 8
   938 = A93D			E_8721	.ds 8
   939 = A945			E_8729	.ds 8
   940 = A94D			E_8731	.ds 1
   941 = A94E			E_8732	.ds 1
   942 = A94F			E_8733	.ds 1
   943 = A950			E_8734	.ds 1
   944 = A951			E_8735	.ds 8
   945 = A959			E_873D	.ds 2
   946
   947 = A95B			header	.ds 2
   948 = A95D			loaadr	.ds 2
   949 = A95F			endadr	.ds 2
   950
   951 = A961			temp	.ds 23
   952
   953 				.print *
   953 				$A978
   954
   955 02E2-02E3> A2 A1			ini main
