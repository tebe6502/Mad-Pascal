mads 2.1.3 build 46 (23 Aug 21)
Source: dli_vbl.a65
     1 				; ------------------------------------------------------------
     2 				; Mad Pascal Compiler version 1.6.6 [2021/09/11] for 6502
     3 				; ------------------------------------------------------------
     4
     5 = 0010			STACKWIDTH	= 16
     6 = 2000			CODEORIGIN	= $2000
     7
     8 = 0001			TRUE		= 1
     9 = 0000			FALSE		= 0
    10
    11 				; ------------------------------------------------------------
    12
    13 					org $80
    14
    15 = 0080			fxptr	.ds 2						; VBXE pointer
    16 = 0082			psptr	.ds 2						; PROGRAMSTACK Pointer
    17
    18 = 0084			bp	.ds 2
    19 = 0086			bp2	.ds 2
    20
    21 = 0088			eax	.ds 4						;8 bytes (aex + edx) -> divREAL
    22 = 008C			edx	.ds 4
    23 = 0090			ecx	.ds 4
    24
    25 				TMP
    26 				ztmp
    27 = 0094			ztmp8	.ds 1
    28 = 0095			ztmp9	.ds 1
    29 = 0096			ztmp10	.ds 1
    30 = 0097			ztmp11	.ds 1
    31
    32 = 0098			STACKORIGIN	.ds STACKWIDTH*4
    33 				zpend
    34
    35 				; ------------------------------------------------------------
    36
    37 = 0088			ax	= eax
    38 = 0088			al	= eax
    39 = 0089			ah	= eax+1
    40
    41 = 0090			cx	= ecx
    42 = 0090			cl	= ecx
    43 = 0091			ch	= ecx+1
    44
    45 = 008C			dx	= edx
    46 = 008C			dl	= edx
    47 = 008D			dh	= edx+1
    48
    49 					org eax
    50
    51 = 0088			FP1MAN0	.ds 1
    52 = 0089			FP1MAN1	.ds 1
    53 = 008A			FP1MAN2	.ds 1
    54 = 008B			FP1MAN3	.ds 1
    55
    56 					org ztmp8
    57
    58 = 0094			FP1SGN	.ds 1
    59 = 0095			FP1EXP	.ds 1
    60
    61 					org edx
    62
    63 = 008C			FP2MAN0	.ds 1
    64 = 008D			FP2MAN1	.ds 1
    65 = 008E			FP2MAN2	.ds 1
    66 = 008F			FP2MAN3	.ds 1
    67
    68 					org ztmp10
    69
    70 = 0096			FP2SGN	.ds 1
    71 = 0097			FP2EXP	.ds 1
    72
    73 					org ecx
    74
    75 = 0090			FPMAN0	.ds 1
    76 = 0091			FPMAN1	.ds 1
    77 = 0092			FPMAN2	.ds 1
    78 = 0093			FPMAN3	.ds 1
    79
    80 					org bp2
    81
    82 = 0086			FPSGN	.ds 1
    83 = 0087			FPEXP	.ds 1
    84
    85 					.ifdef MAIN.@DEFINES.BASICOFF
    86 					org CODEORIGIN
    87 					icl 'atari\basicoff.asm'
    88 					ini CODEORIGIN
    89 					.endif
    90
    91 					.ifdef MAIN.@DEFINES.S_VBXE
    92 					opt h-
    93 					ins 'atari\s_vbxe\sdxld2.obx'
    94 					opt h+
    95 					.endif
    96
    97 				.local	RESOURCE
    98 					icl 'atari\resource.asm'
Source: resource.asm
     1
  1133 					opt l+
    99 = 0000				?EXTDETECT = 0
   100 = 0000				?VBXDETECT = 0
   101
   102 2000				RMTPLAY 'assets\bootup.feat' RMT_PLAYER 2 0 0 0 0 0 0 0
Macro: RESOURCE.RMTPLAY [Source: resource.asm]
     2 = 0002			STEREOMODE	= 2
     3 = A000			PLAYER		= main.RMT_PLAYER
Source: rmt_player.asm
    27 = 0004			TRACKS		equ 4
    37 					org $e0
    38 				p_tis
    39 				p_instrstable		org *+2
    40 				p_trackslbstable	org *+2
    41 				p_trackshbstable	org *+2
    42 				p_song			org *+2
    43 				ns			org *+2
    44 				nr			org *+2
    45 				nt			org *+2
    46 				reg1			org *+1
    47 				reg2			org *+1
    48 				reg3			org *+1
    49 				tmp			org *+1
    57 					org PLAYER-$400+$e0
    59 				track_variables
    60 				trackn_db	org *+TRACKS
    61 				trackn_hb	org *+TRACKS
    62 				trackn_idx	org *+TRACKS
    63 				trackn_pause	org *+TRACKS
    64 				trackn_note	org *+TRACKS
    65 				trackn_volume	org *+TRACKS
    66 				trackn_distor 	org *+TRACKS
    67 				trackn_shiftfrq	org *+TRACKS
    75 				trackn_instrx2	org *+TRACKS
    76 				trackn_instrdb	org *+TRACKS
    77 				trackn_instrhb	org *+TRACKS
    78 				trackn_instridx	org *+TRACKS
    79 				trackn_instrlen	org *+TRACKS
    80 				trackn_instrlop	org *+TRACKS
    81 				trackn_instrreachend	org *+TRACKS
    82 				trackn_volumeslidedepth org *+TRACKS
    83 				trackn_volumeslidevalue org *+TRACKS
    87 = 0000			FEAT_EFFECTS equ FEAT_EFFECTVIBRATO||FEAT_EFFECTFSHIFT
    97 				trackn_tabletypespeed org *+TRACKS
   101 				trackn_tablenote	org *+TRACKS
   102 				trackn_tablea		org *+TRACKS
   103 				trackn_tableend		org *+TRACKS
   107 				trackn_tablespeeda	org *+TRACKS
   117 				trackn_audf	org *+TRACKS
   118 				trackn_audc	org *+TRACKS
   122 				v_aspeed		org *+1
   123 				track_endvariables
   124 						org PLAYER-$100-$140-$40+2
   125 = 000C			INSTRPAR	equ 12
   126 				tabbeganddistor
   127 FFFF> 9D82-9D91> 80 00	 dta frqtabpure-frqtab,$00
   128 9D84 80 20		 dta frqtabpure-frqtab,$20
   129 9D86 80 40		 dta frqtabpure-frqtab,$40
   130 9D88 00 C0		 dta frqtabbass1-frqtab,$c0
   131 9D8A 80 80		 dta frqtabpure-frqtab,$80
   132 9D8C 80 A0		 dta frqtabpure-frqtab,$a0
   133 9D8E 00 C0		 dta frqtabbass1-frqtab,$c0
   134 9D90 40 C0		 dta frqtabbass2-frqtab,$c0
   147 9D92					org PLAYER-$100-$140
   155 9DC0					org PLAYER-$100-$100
   156 9E00			frqtab
   158 9E00			frqtabbass1
   159 9E00-9EBF> BF B6 AA A1 + 	dta $BF,$B6,$AA,$A1,$98,$8F,$89,$80,$F2,$E6,$DA,$CE,$BF,$B6,$AA,$A1
   160 9E10 98 8F 89 80 7A 71 + 	dta $98,$8F,$89,$80,$7A,$71,$6B,$65,$5F,$5C,$56,$50,$4D,$47,$44,$3E
   161 9E20 3C 38 35 32 2F 2D + 	dta $3C,$38,$35,$32,$2F,$2D,$2A,$28,$25,$23,$21,$1F,$1D,$1C,$1A,$18
   162 9E30 17 16 14 13 12 11 + 	dta $17,$16,$14,$13,$12,$11,$10,$0F,$0E,$0D,$0C,$0B,$0A,$09,$08,$07
   163 9E40			frqtabbass2
   164 9E40 FF F1 E4 D8 CA C0 + 	dta $FF,$F1,$E4,$D8,$CA,$C0,$B5,$AB,$A2,$99,$8E,$87,$7F,$79,$73,$70
   165 9E50 66 61 5A 55 52 4B + 	dta $66,$61,$5A,$55,$52,$4B,$48,$43,$3F,$3C,$39,$37,$33,$30,$2D,$2A
   166 9E60 28 25 24 21 1F 1E + 	dta $28,$25,$24,$21,$1F,$1E,$1C,$1B,$19,$17,$16,$15,$13,$12,$11,$10
   167 9E70 0F 0E 0D 0C 0B 0A + 	dta $0F,$0E,$0D,$0C,$0B,$0A,$09,$08,$07,$06,$05,$04,$03,$02,$01,$00
   168 9E80			frqtabpure
   169 9E80 F3 E6 D9 CC C1 B5 + 	dta $F3,$E6,$D9,$CC,$C1,$B5,$AD,$A2,$99,$90,$88,$80,$79,$72,$6C,$66
   170 9E90 60 5B 55 51 4C 48 + 	dta $60,$5B,$55,$51,$4C,$48,$44,$40,$3C,$39,$35,$32,$2F,$2D,$2A,$28
   171 9EA0 25 23 21 1F 1D 1C + 	dta $25,$23,$21,$1F,$1D,$1C,$1A,$18,$17,$16,$14,$13,$12,$11,$10,$0F
   172 9EB0 0E 0D 0C 0B 0A 09 + 	dta $0E,$0D,$0C,$0B,$0A,$09,$08,$07,$06,$05,$04,$03,$02,$01,$00,$00
   180 9EC0					org PLAYER-$0100
   181 9F00			volumetab
   182 9F00-A300> 00 00 00 00 + 	dta $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
   183 9F10 00 00 00 00 00 00 + 	dta $00,$00,$00,$00,$00,$00,$00,$00,$01,$01,$01,$01,$01,$01,$01,$01
   184 9F20 00 00 00 00 01 01 + 	dta $00,$00,$00,$00,$01,$01,$01,$01,$01,$01,$01,$01,$02,$02,$02,$02
   185 9F30 00 00 00 01 01 01 + 	dta $00,$00,$00,$01,$01,$01,$01,$01,$02,$02,$02,$02,$02,$03,$03,$03
   186 9F40 00 00 01 01 01 01 + 	dta $00,$00,$01,$01,$01,$01,$02,$02,$02,$02,$03,$03,$03,$03,$04,$04
   187 9F50 00 00 01 01 01 02 + 	dta $00,$00,$01,$01,$01,$02,$02,$02,$03,$03,$03,$04,$04,$04,$05,$05
   188 9F60 00 00 01 01 02 02 + 	dta $00,$00,$01,$01,$02,$02,$02,$03,$03,$04,$04,$04,$05,$05,$06,$06
   189 9F70 00 00 01 01 02 02 + 	dta $00,$00,$01,$01,$02,$02,$03,$03,$04,$04,$05,$05,$06,$06,$07,$07
   190 9F80 00 01 01 02 02 03 + 	dta $00,$01,$01,$02,$02,$03,$03,$04,$04,$05,$05,$06,$06,$07,$07,$08
   191 9F90 00 01 01 02 02 03 + 	dta $00,$01,$01,$02,$02,$03,$04,$04,$05,$05,$06,$07,$07,$08,$08,$09
   192 9FA0 00 01 01 02 03 03 + 	dta $00,$01,$01,$02,$03,$03,$04,$05,$05,$06,$07,$07,$08,$09,$09,$0A
   193 9FB0 00 01 01 02 03 04 + 	dta $00,$01,$01,$02,$03,$04,$04,$05,$06,$07,$07,$08,$09,$0A,$0A,$0B
   194 9FC0 00 01 02 02 03 04 + 	dta $00,$01,$02,$02,$03,$04,$05,$06,$06,$07,$08,$09,$0A,$0A,$0B,$0C
   195 9FD0 00 01 02 03 03 04 + 	dta $00,$01,$02,$03,$03,$04,$05,$06,$07,$08,$09,$0A,$0A,$0B,$0C,$0D
   196 9FE0 00 01 02 03 04 05 + 	dta $00,$01,$02,$03,$04,$05,$06,$07,$07,$08,$09,$0A,$0B,$0C,$0D,$0E
   197 9FF0 00 01 02 03 04 05 + 	dta $00,$01,$02,$03,$04,$05,$06,$07,$08,$09,$0A,$0B,$0C,$0D,$0E,$0F
   198 A000				org PLAYER
   202 A000			RASTERMUSICTRACKER
   203 A000 4C A0 A1			jmp rmt_play
   205 A003 4C 0F A0			jmp rmt_init
   206 A006 4C BA A1			jmp rmt_p3
   207 A009 4C 4A A0			jmp rmt_silence
   208 A00C 4C BF A2			jmp SetPokey
   212 A00F			rmt_init
   213 A00F 86 E8			stx ns
   214 A011 84 E9			sty ns+1
   216 A013 48				pha
   226 A014 A0 61			ldy #track_endvariables-track_variables
   227 A016 A9 00			lda #0
   228 A018 99 DF 9C		ri0	sta track_variables-1,y
   229 A01B 88				dey
   230 A01C D0 FA			bne ri0
   232 A01E A0 04			ldy #4
   233 A020 B1 E8			lda (ns),y
   234 A022 8D AE A1			sta v_maxtracklen
   235 A025 C8				iny
   249 A026 A0 08			ldy #8
   250 A028 B1 E8		ri1	lda (ns),y
   251 A02A 99 D8 00			sta p_tis-8,y
   252 A02D C8				iny
   253 A02E C0 10			cpy #8+8
   254 A030 D0 F6			bne ri1
   256 A032 68				pla
   257 A033 48				pha
   273 A034 0A				asl @
   274 A035 0A				asl @
   275 A036 18				clc
   276 A037 65 E6			adc p_song
   277 A039 85 E6			sta p_song
   278 A03B 68				pla
   279 A03C 08				php
   280 A03D 29 C0			and #$c0
   281 A03F 0A				asl @
   282 A040 2A				rol @
   283 A041 2A				rol @
   285 A042 28				plp
   286 A043 65 E7			adc p_song+1
   287 A045 85 E7			sta p_song+1
   289 A047 20 68 A0			jsr GetSongLineTrackLineInitOfNewSetInstrumentsOnlyRmtp3
   290 A04A			rmt_silence
   292 A04A A9 00			lda #0
   293 A04C 8D 08 D2			sta $d208
   294 A04F 8D 18 D2			sta $d218
   295 A052 A0 03			ldy #3
   296 A054 8C 0F D2			sty $d20f
   297 A057 8C 1F D2			sty $d21f
   298 A05A A0 08			ldy #8
   299 A05C 99 00 D2		si1	sta $d200,y
   300 A05F 99 10 D2			sta $d210,y
   301 A062 88				dey
   302 A063 10 F7			bpl si1
   316 A065 A9 01			lda #FEAT_INSTRSPEED
   318 A067 60				rts
   319 A068			GetSongLineTrackLineInitOfNewSetInstrumentsOnlyRmtp3
   320 A068			GetSongLine
   321 A068 A2 00			ldx #0
   322 A06A 8E AC A1			stx v_abeat
   323 A06D			nn0
   324 A06D 8A			nn1	txa
   325 A06E A8				tay
   326 A06F B1 E6			lda (p_song),y
   327 A071 C9 FE			cmp #$fe
   328 A073 B0 2D			bcs nn2
   329 A075 A8				tay
   330 A076 B1 E2			lda (p_trackslbstable),y
   331 A078 9D E0 9C			sta trackn_db,x
   332 A07B B1 E4			lda (p_trackshbstable),y
   333 A07D 9D E4 9C		nn1a sta trackn_hb,x
   334 A080 A9 00			lda #0
   335 A082 9D E8 9C			sta trackn_idx,x
   336 A085 A9 01			lda #1
   337 A087 9D EC 9C		nn1a2 sta trackn_pause,x
   338 A08A A9 80			lda #$80
   339 A08C 9D 00 9D			sta trackn_instrx2,x
   340 A08F E8				inx
   341 A090 E0 04		xtracks01	cpx #TRACKS
   342 A092 D0 D9			bne nn1
   343 A094 A5 E6			lda p_song
   344 A096 18				clc
   345 A097 69 04		xtracks02	adc #TRACKS
   346 A099 85 E6			sta p_song
   347 A09B 90 1B			bcc GetTrackLine
   348 A09D E6 E7			inc p_song+1
   349 A09F			nn1b
   350 A09F 4C B8 A0			jmp GetTrackLine
   351 A0A2			nn2
   352 A0A2 F0 04			beq nn3
   353 A0A4			nn2a
   354 A0A4 A9 00			lda #0
   355 A0A6 F0 DF			beq nn1a2
   356 A0A8			nn3
   357 A0A8 A0 02			ldy #2
   358 A0AA B1 E6			lda (p_song),y
   359 A0AC AA				tax
   360 A0AD C8				iny
   361 A0AE B1 E6			lda (p_song),y
   362 A0B0 85 E7			sta p_song+1
   363 A0B2 86 E6			stx p_song
   364 A0B4 A2 00			ldx #0
   365 A0B6 F0 B5			beq nn0
   366 A0B8			GetTrackLine
   367 A0B8			oo0
   368 A0B8			oo0a
   374 A0B8 A2 FF			ldx #-1
   375 A0BA			oo1
   376 A0BA E8				inx
   377 A0BB DE EC 9C			dec trackn_pause,x
   378 A0BE D0 42			bne oo1x
   379 A0C0			oo1b
   380 A0C0 BD E0 9C			lda trackn_db,x
   381 A0C3 85 E8			sta ns
   382 A0C5 BD E4 9C			lda trackn_hb,x
   383 A0C8 85 E9			sta ns+1
   384 A0CA			oo1i
   385 A0CA BC E8 9C			ldy trackn_idx,x
   386 A0CD FE E8 9C			inc trackn_idx,x
   387 A0D0 B1 E8			lda (ns),y
   388 A0D2 85 EE			sta reg1
   389 A0D4 29 3F			and #$3f
   390 A0D6 C9 3D			cmp #61
   391 A0D8 F0 0E			beq oo1a
   392 A0DA B0 32			bcs oo2
   393 A0DC 9D F0 9C			sta trackn_note,x
   397 A0DF C8				iny
   398 A0E0 B1 E8			lda (ns),y
   399 A0E2 4A				lsr @
   400 A0E3 29 7E			and #$3f*2
   401 A0E5 9D 00 9D			sta trackn_instrx2,x
   402 A0E8			oo1a
   403 A0E8 A9 01			lda #1
   404 A0EA 9D EC 9C			sta trackn_pause,x
   405 A0ED BC E8 9C			ldy trackn_idx,x
   406 A0F0 FE E8 9C			inc trackn_idx,x
   407 A0F3 B1 E8			lda (ns),y
   408 A0F5 4A				lsr @
   409 A0F6 66 EE			ror reg1
   410 A0F8 4A				lsr @
   411 A0F9 66 EE			ror reg1
   412 A0FB A5 EE			lda reg1
   421 A0FD 29 F0			and #$f0
   422 A0FF 9D F4 9C			sta trackn_volume,x
   423 A102			oo1x
   424 A102 E0 03		xtracks03sub1	cpx #TRACKS-1
   425 A104 D0 B4			bne oo1
   431 A106 A9 06			lda #FEAT_CONSTANTSPEED
   433 A108 8D 40 9D			sta v_aspeed
   434 A10B 4C 45 A1			jmp InitOfNewSetInstrumentsOnly
   435 A10E			oo2
   436 A10E C9 3F			cmp #63
   437 A110 F0 1B			beq oo63
   438 A112 A5 EE			lda reg1
   439 A114 29 C0			and #$c0
   440 A116 F0 09			beq oo62_b
   441 A118 0A				asl @
   442 A119 2A				rol @
   443 A11A 2A				rol @
   444 A11B 9D EC 9C			sta trackn_pause,x
   445 A11E 4C 02 A1			jmp oo1x
   446 A121			oo62_b
   447 A121 C8				iny
   448 A122 B1 E8			lda (ns),y
   449 A124 9D EC 9C			sta trackn_pause,x
   450 A127 FE E8 9C			inc trackn_idx,x
   451 A12A 4C 02 A1			jmp oo1x
   452 A12D			oo63
   453 A12D A5 EE			lda reg1
   463 A12F C9 FF			cmp #255
   464 A131 F0 09			beq oo63_11
   465 A133 C8				iny
   466 A134 B1 E8			lda (ns),y
   467 A136 9D E8 9C			sta trackn_idx,x
   468 A139 4C CA A0			jmp oo1i
   469 A13C			oo63_11
   470 A13C 4C 68 A0			jmp GetSongLine
   471 A13F 4C BA A1		p2xrmtp3	jmp rmt_p3
   472 A142 CA			p2x0 dex
   473 A143 30 FA			 bmi p2xrmtp3
   474 A145			InitOfNewSetInstrumentsOnly
   475 A145 BC 00 9D		p2x1 ldy trackn_instrx2,x
   476 A148 30 F8			bmi p2x0
   489 A14A			SetUpInstrumentY2
   490 A14A B1 E0			lda (p_instrstable),y
   491 A14C 9D 04 9D			sta trackn_instrdb,x
   492 A14F 85 EC			sta nt
   493 A151 C8				iny
   494 A152 B1 E0			lda (p_instrstable),y
   495 A154 9D 08 9D			sta trackn_instrhb,x
   496 A157 85 ED			sta nt+1
   511 A159 A0 02			ldy #2
   513 A15B B1 EC			lda (nt),y
   514 A15D 9D 10 9D			sta trackn_instrlen,x
   515 A160 C8				iny
   516 A161 B1 EC			lda (nt),y
   517 A163 9D 14 9D			sta trackn_instrlop,x
   518 A166 C8				iny
   519 A167 B1 EC			lda (nt),y
   520 A169 9D 24 9D			sta trackn_tabletypespeed,x
   522 A16C 29 3F			and #$3f
   524 A16E 9D 34 9D			sta trackn_tablespeeda,x
   536 A171 A0 06			ldy #6
   538 A173 B1 EC			lda (nt),y
   539 A175 9D 1C 9D			sta trackn_volumeslidedepth,x
   568 A178 A9 80			lda #128
   569 A17A 9D 20 9D			sta trackn_volumeslidevalue,x
   570 A17D 9D 00 9D			sta trackn_instrx2,x
   571 A180 0A				asl @
   572 A181 9D 18 9D			sta trackn_instrreachend,x
   573 A184 9D FC 9C			sta trackn_shiftfrq,x
   574 A187 A8				tay
   575 A188 B1 EC			lda (nt),y
   576 A18A 9D 30 9D			sta trackn_tableend,x
   577 A18D 69 00			adc #0
   578 A18F 9D 0C 9D			sta trackn_instridx,x
   579 A192 A9 0C			lda #INSTRPAR
   580 A194 9D 2C 9D			sta trackn_tablea,x
   581 A197 A8				tay
   582 A198 B1 EC			lda (nt),y
   583 A19A 9D 28 9D			sta trackn_tablenote,x
   584 A19D			xata_rtshere
   588 A19D 4C 42 A1			jmp p2x0
   590 A1A0			rmt_play
   591 A1A0			rmt_p0
   592 A1A0 20 BF A2			jsr SetPokey
   593 A1A3			rmt_p1
   606 A1A3			rmt_p2
   607 A1A3 CE 40 9D			dec v_aspeed
   608 A1A6 D0 12			bne rmt_p3
   609 A1A8 EE AC A1			inc v_abeat
   610 A1AB A9 FF			lda #$ff
   611 = A1AC			v_abeat equ *-1
   612 A1AD C9 FF			cmp #$ff
   613 = A1AE			v_maxtracklen equ *-1
   614 A1AF F0 03			beq p2o3
   615 A1B1 4C B8 A0			jmp GetTrackLine
   616 A1B4			p2o3
   617 A1B4 4C 68 A0			jmp GetSongLineTrackLineInitOfNewSetInstrumentsOnlyRmtp3
   618 A1B7 4C AE A2		go_ppnext	jmp ppnext
   619 A1BA			rmt_p3
   620 A1BA A9 9E			lda #>frqtab
   621 A1BC 85 EB			sta nr+1
   622 A1BE A2 03		xtracks05sub1	ldx #TRACKS-1
   623 A1C0			pp1
   624 A1C0 BD 08 9D			lda trackn_instrhb,x
   625 A1C3 F0 F2			beq go_ppnext
   626 A1C5 85 E9			sta ns+1
   627 A1C7 BD 04 9D			lda trackn_instrdb,x
   628 A1CA 85 E8			sta ns
   629 A1CC BC 0C 9D			ldy trackn_instridx,x
   630 A1CF B1 E8			lda (ns),y
   631 A1D1 85 EE			sta reg1
   632 A1D3 C8				iny
   633 A1D4 B1 E8			lda (ns),y
   634 A1D6 85 EF			sta reg2
   635 A1D8 C8				iny
   636 A1D9 B1 E8			lda (ns),y
   637 A1DB 85 F0			sta reg3
   638 A1DD C8				iny
   639 A1DE 98				tya
   640 A1DF DD 10 9D			cmp trackn_instrlen,x
   641 A1E2 90 0A			bcc pp2
   642 A1E4 F0 08			beq pp2
   643 A1E6 A9 80			lda #$80
   644 A1E8 9D 18 9D			sta trackn_instrreachend,x
   645 A1EB			pp1b
   646 A1EB BD 14 9D			lda trackn_instrlop,x
   647 A1EE 9D 0C 9D		pp2	sta trackn_instridx,x
   648 A1F1 A5 EE			lda reg1
   658 A1F3 29 0F			and #$0f
   659 A1F5 1D F4 9C			ora trackn_volume,x
   660 A1F8 A8				tay
   661 A1F9 B9 00 9F			lda volumetab,y
   662 A1FC 85 F1			sta tmp
   663 A1FE A5 EF			lda reg2
   664 A200 29 0E			and #$0e
   665 A202 A8				tay
   666 A203 B9 82 9D			lda tabbeganddistor,y
   667 A206 85 EA			sta nr
   668 A208 A5 F1			lda tmp
   669 A20A 19 83 9D			ora tabbeganddistor+1,y
   670 A20D 9D 3C 9D			sta trackn_audc,x
   671 A210			InstrumentsEffects
   697 A210 BC 30 9D			ldy trackn_tableend,x
   698 A213 C0 0D			cpy #INSTRPAR+1
   699 A215 90 32			bcc ei3
   700 A217 BD 34 9D			lda trackn_tablespeeda,x
   701 A21A 10 27			bpl ei2f
   702 A21C			ei2c
   703 A21C 98				tya
   704 A21D DD 2C 9D			cmp trackn_tablea,x
   705 A220 D0 07			bne ei2c2
   709 A222 A9 0C			lda #INSTRPAR
   711 A224 9D 2C 9D			sta trackn_tablea,x
   712 A227 D0 03			bne ei2a
   713 A229			ei2c2
   714 A229 FE 2C 9D			inc trackn_tablea,x
   715 A22C			ei2a
   716 A22C BD 04 9D			lda trackn_instrdb,x
   717 A22F 85 EC			sta nt
   718 A231 BD 08 9D			lda trackn_instrhb,x
   719 A234 85 ED			sta nt+1
   720 A236 BC 2C 9D			ldy trackn_tablea,x
   721 A239 B1 EC			lda (nt),y
   729 A23B 9D 28 9D			sta trackn_tablenote,x
   730 A23E BD 24 9D			lda trackn_tabletypespeed,x
   732 A241 29 3F			and #$3f
   734 A243			ei2f
   735 A243 38				sec
   736 A244 E9 01			sbc #1
   737 A246 9D 34 9D			sta trackn_tablespeeda,x
   738 A249			ei3
   739 A249 BD 18 9D			lda trackn_instrreachend,x
   740 A24C 10 18			bpl ei4
   741 A24E BD F4 9C			lda trackn_volume,x
   742 A251 F0 13			beq ei4
   748 A253 A8				tay
   749 A254 BD 20 9D			lda trackn_volumeslidevalue,x
   750 A257 18				clc
   751 A258 7D 1C 9D			adc trackn_volumeslidedepth,x
   752 A25B 9D 20 9D			sta trackn_volumeslidevalue,x
   753 A25E 90 06			bcc ei4
   754 A260 98				tya
   755 A261 E9 10			sbc #16
   756 A263 9D F4 9C			sta trackn_volume,x
   757 A266			ei4
   763 A266 A5 EF			lda reg2
   767 A268 29 70			and #$70
   769 A26A F0 05			beq cmd0
   809 A26C			cmd1
   811 A26C A5 F0			lda reg3
   812 A26E 4C AB A2			jmp cmd0c
   814 A271			cmd2
   821 A271			cmd3
   829 A271			cmd4
   838 A271			cmd5
   881 A271			cmd6
   893 A271			cmd7
   913 A271			cmd0
   914 A271 BD F0 9C			lda trackn_note,x
   915 A274 18				clc
   916 A275 65 F0			adc reg3
   917 A277			cmd0a
   919 A277 BC 24 9D			ldy trackn_tabletypespeed,x
   920 A27A 30 19			bmi cmd0b
   922 A27C 18				clc
   923 A27D 7D 28 9D			adc trackn_tablenote,x
   924 A280 C9 3D			cmp #61
   925 A282 90 07			bcc cmd0a1
   926 A284 A9 00			lda #0
   927 A286 9D 3C 9D			sta trackn_audc,x
   928 A289 A9 3F			lda #63
   929 A28B			cmd0a1
   933 A28B A8				tay
   934 A28C B1 EA			lda (nr),y
   935 A28E 18				clc
   936 A28F 7D FC 9C			adc trackn_shiftfrq,x
   942 A292 4C AB A2			jmp cmd0c
   943 A295			cmd0b
   944 A295 C9 3D			cmp #61
   945 A297 90 07			bcc cmd0b1
   946 A299 A9 00			lda #0
   947 A29B 9D 3C 9D			sta trackn_audc,x
   948 A29E A9 3F			lda #63
   949 A2A0			cmd0b1
   950 A2A0 A8				tay
   951 A2A1 BD FC 9C			lda trackn_shiftfrq,x
   952 A2A4 18				clc
   953 A2A5 7D 28 9D			adc trackn_tablenote,x
   954 A2A8 18				clc
   955 A2A9 71 EA			adc (nr),y
   961 A2AB			cmd0c
   962 A2AB 9D 38 9D			sta trackn_audf,x
   963 A2AE			pp9
   999 A2AE			ppnext
  1000 A2AE CA				dex
  1001 A2AF 30 03			bmi rmt_p4
  1002 A2B1 4C C0 A1			jmp pp1
  1003 A2B4			rmt_p4
  1011 A2B4 A2 00			ldx #0
  1013 A2B6			qq1
  1014 A2B6 8E C0 A2			stx v_audctl
  1120 A2B9			qq5
  1121 A2B9 8E C0 A2			stx v_audctl
  1241 A2BC			rmt_p5
  1246 A2BC A9 01			lda #1
  1248 A2BE 60				rts
  1249 A2BF			SetPokey
  1310 A2BF A0 FF			ldy #$ff
  1311 = A2C0			v_audctl equ *-1
  1312 A2C1 AD 38 9D			lda trackn_audf+0
  1313 A2C4 AE 3C 9D			ldx trackn_audc+0
  1314 A2C7 8D 00 D2			sta $d200
  1315 A2CA 8E 01 D2			stx $d201
  1316 A2CD 8D 10 D2			sta $d210
  1317 A2D0 AD 39 9D			lda trackn_audf+1
  1318 A2D3 AE 3D 9D			ldx trackn_audc+1
  1319 A2D6 8D 12 D2			sta $d210+2
  1320 A2D9 8E 13 D2			stx $d211+2
  1321 A2DC AD 3A 9D			lda trackn_audf+2
  1322 A2DF AE 3E 9D			ldx trackn_audc+2
  1323 A2E2 8D 14 D2			sta $d210+4
  1324 A2E5 8E 15 D2			stx $d211+4
  1325 A2E8 8D 04 D2			sta $d200+4
  1326 A2EB AD 3B 9D			lda trackn_audf+3
  1327 A2EE AE 3F 9D			ldx trackn_audc+3
  1328 A2F1 8D 06 D2			sta $d200+6
  1329 A2F4 8E 07 D2			stx $d201+6
  1330 A2F7 8D 16 D2			sta $d210+6
  1331 A2FA 8C 18 D2			sty $d218
  1332 A2FD 8C 08 D2			sty $d208
  1357 A300 60				rts
  1358 A301			RMTPLAYEREND
Source: bootup.feat
     3 = 0000			FEAT_SFX		equ 0
     4 = 0000			FEAT_GLOBALVOLUMEFADE	equ 0		;RMTGLOBALVOLUMEFADE variable
     5 = 0000			FEAT_NOSTARTINGSONGLINE	equ 0
     6 = 0001			FEAT_INSTRSPEED		equ 1
     7 = 0006			FEAT_CONSTANTSPEED		equ 6		;(0 times)
     8 = 0001			FEAT_COMMAND1		equ 1		;(28 times)
     9 = 0000			FEAT_COMMAND2		equ 0		;(0 times)
    10 = 0000			FEAT_COMMAND3		equ 0		;(0 times)
    11 = 0000			FEAT_COMMAND4		equ 0		;(0 times)
    12 = 0000			FEAT_COMMAND5		equ 0		;(0 times)
    13 = 0000			FEAT_COMMAND6		equ 0		;(0 times)
    14 = 0000			FEAT_COMMAND7SETNOTE		equ 0		;(0 times)
    15 = 0000			FEAT_COMMAND7VOLUMEONLY		equ 0		;(0 times)
    16 = 0000			FEAT_PORTAMENTO		equ 0		;(0 times)
    17 = 0000			FEAT_FILTER		equ 0		;(0 times)
    18 = 0000			FEAT_FILTERG0L		equ 0		;(0 times)
    19 = 0000			FEAT_FILTERG1L		equ 0		;(0 times)
    20 = 0000			FEAT_FILTERG0R		equ 0		;(0 times)
    21 = 0000			FEAT_FILTERG1R		equ 0		;(0 times)
    22 = 0000			FEAT_BASS16		equ 0		;(0 times)
    23 = 0000			FEAT_BASS16G1L		equ 0		;(0 times)
    24 = 0000			FEAT_BASS16G3L		equ 0		;(0 times)
    25 = 0000			FEAT_BASS16G1R		equ 0		;(0 times)
    26 = 0000			FEAT_BASS16G3R		equ 0		;(0 times)
    27 = 0000			FEAT_VOLUMEONLYG0L		equ 0		;(0 times)
    28 = 0000			FEAT_VOLUMEONLYG2L		equ 0		;(0 times)
    29 = 0000			FEAT_VOLUMEONLYG3L		equ 0		;(0 times)
    30 = 0000			FEAT_VOLUMEONLYG0R		equ 0		;(0 times)
    31 = 0000			FEAT_VOLUMEONLYG2R		equ 0		;(0 times)
    32 = 0000			FEAT_VOLUMEONLYG3R		equ 0		;(0 times)
    33 = 0001			FEAT_TABLETYPE		equ 1		;(1 times)
    34 = 0000			FEAT_TABLEMODE		equ 0		;(0 times)
    35 = 0000			FEAT_TABLEGO		equ 0		;(0 times)
    36 = 0000			FEAT_AUDCTLMANUALSET		equ 0		;(0 times)
    37 = 0000			FEAT_VOLUMEMIN		equ 0		;(0 times)
    38 = 0000			FEAT_EFFECTVIBRATO		equ 0		;(0 times)
    39 = 0000			FEAT_EFFECTFSHIFT		equ 0		;(0 times)
    13 					.echo '$R RMTPLAY ',track_variables,'..',RMTPLAYEREND," 'assets\bootup.feat'"
    13 				$R RMTPLAY $9CE0..$A301 'assets\bootup.feat'
Source: dli_vbl.a65
   103 A301				RMT 'assets\bootup.rmt' RMT_MODUL 0 0 0 0 0 0 0 0
Macro: RESOURCE.RMT [Source: resource.asm]
     2 = 08A3			len = .filesize('assets\bootup.rmt')
    28 A301				org main.RMT_MODUL
     2 4000				.get [$100] 'assets\bootup.rmt',0,6				// wczytujemy plik do bufora MADS'a
     6 = 4000			new_add = MAIN.RMT_MODUL						// nowy adres dla modulu RMT
     8 = 4000			old_add	= .wget[$102]					// stary adres modulu RMT
    10 = 089D			length	= .wget[$104] - old_add + 1			// dlugosc pliku RMT bez naglowka DOS'u
    12 = 0000			ofset	= new_add-old_add
    14 4000				.get [old_add-6] 'assets\bootup.rmt'
    16  [3FFC] 00			.put[old_add-4] = .lo(new_add)			// poprawiamy nag³ówek DOS'a
    17  [3FFD] 40			.put[old_add-3] = .hi(new_add)			// tak aby zawieral informacje o nowym
    19  [3FFE] 9C			.put[old_add-2] = .lo(new_add + length - 1)	// adresie modulu RMT
    20  [3FFF] 48			.put[old_add-1] = .hi(new_add + length - 1)
    22 = 0034			type	= .get[old_add+3]
    24 = 4010			pinst	= .get[old_add+8] + .get[old_add+9]<<8
    25 = 4022			pltrc	= .get[old_add+10] + .get[old_add+11]<<8
    26 = 4045			phtrc	= .get[old_add+12] + .get[old_add+13]<<8
    27 = 4841			ptlst	= .get[old_add+14] + .get[old_add+15]<<8
    29  [4008] 10			.put[old_add+8] = .lo(pinst+ofset)
    30  [4009] 40			.put[old_add+9] = .hi(pinst+ofset)
    32  [400A] 22			.put[old_add+10] = .lo(pltrc+ofset)
    33  [400B] 40			.put[old_add+11] = .hi(pltrc+ofset)
    35  [400C] 45			.put[old_add+12] = .lo(phtrc+ofset)
    36  [400D] 40			.put[old_add+13] = .hi(phtrc+ofset)
    38  [400E] 41			.put[old_add+14] = .lo(ptlst+ofset)
    39  [400F] 48			.put[old_add+15] = .hi(ptlst+ofset)
    43 = 4068				?TMP = .GET[PINST+#*2] + .GET[PINST+#*2+1]<<8
    43  [4010] 68			.PUT[PINST+#*2] = .LO(?TMP+OFSET)
    43  [4011] 40			.PUT[PINST+#*2+1] = .HI(?TMP+OFSET)
    43 = 4082				?TMP = .GET[PINST+#*2] + .GET[PINST+#*2+1]<<8
    43  [4012] 82			.PUT[PINST+#*2] = .LO(?TMP+OFSET)
    43  [4013] 40			.PUT[PINST+#*2+1] = .HI(?TMP+OFSET)
    43 = 40A1				?TMP = .GET[PINST+#*2] + .GET[PINST+#*2+1]<<8
    43  [4014] A1			.PUT[PINST+#*2] = .LO(?TMP+OFSET)
    43  [4015] 40			.PUT[PINST+#*2+1] = .HI(?TMP+OFSET)
    43 = 40CC				?TMP = .GET[PINST+#*2] + .GET[PINST+#*2+1]<<8
    43  [4016] CC			.PUT[PINST+#*2] = .LO(?TMP+OFSET)
    43  [4017] 40			.PUT[PINST+#*2+1] = .HI(?TMP+OFSET)
    43 = 40E8				?TMP = .GET[PINST+#*2] + .GET[PINST+#*2+1]<<8
    43  [4018] E8			.PUT[PINST+#*2] = .LO(?TMP+OFSET)
    43  [4019] 40			.PUT[PINST+#*2+1] = .HI(?TMP+OFSET)
    43 = 40F8				?TMP = .GET[PINST+#*2] + .GET[PINST+#*2+1]<<8
    43  [401A] F8			.PUT[PINST+#*2] = .LO(?TMP+OFSET)
    43  [401B] 40			.PUT[PINST+#*2+1] = .HI(?TMP+OFSET)
    43 = 4111				?TMP = .GET[PINST+#*2] + .GET[PINST+#*2+1]<<8
    43  [401C] 11			.PUT[PINST+#*2] = .LO(?TMP+OFSET)
    43  [401D] 41			.PUT[PINST+#*2+1] = .HI(?TMP+OFSET)
    43 = 412D				?TMP = .GET[PINST+#*2] + .GET[PINST+#*2+1]<<8
    43  [401E] 2D			.PUT[PINST+#*2] = .LO(?TMP+OFSET)
    43  [401F] 41			.PUT[PINST+#*2+1] = .HI(?TMP+OFSET)
    43 = 413D				?TMP = .GET[PINST+#*2] + .GET[PINST+#*2+1]<<8
    43  [4020] 3D			.PUT[PINST+#*2] = .LO(?TMP+OFSET)
    43  [4021] 41			.PUT[PINST+#*2+1] = .HI(?TMP+OFSET)
    52 = 4165				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4022] 65			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4045] 41			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 416D				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4023] 6D			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4046] 41			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 4193				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4024] 93			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4047] 41			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 41CF				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4025] CF			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4048] 41			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 420B				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4026] 0B			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4049] 42			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 425C				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4027] 5C			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [404A] 42			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 42B8				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4028] B8			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [404B] 42			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 42F3				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4029] F3			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [404C] 42			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 432D				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [402A] 2D			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [404D] 43			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 4367				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [402B] 67			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [404E] 43			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 439D				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [402C] 9D			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [404F] 43			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 43C7				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [402D] C7			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4050] 43			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 43F0				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [402E] F0			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4051] 43			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 440C				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [402F] 0C			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4052] 44			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 4470				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4030] 70			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4053] 44			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 44AD				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4031] AD			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4054] 44			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 44FA				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4032] FA			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4055] 44			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 454E				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4033] 4E			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4056] 45			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 456A				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4034] 6A			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4057] 45			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 45B2				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4035] B2			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4058] 45			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 460E				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4036] 0E			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4059] 46			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 4674				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4037] 74			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [405A] 46			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 46AD				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4038] AD			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [405B] 46			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 46DB				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4039] DB			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [405C] 46			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 471C				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [403A] 1C			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [405D] 47			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 4756				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [403B] 56			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [405E] 47			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 4785				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [403C] 85			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [405F] 47			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 47C7				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [403D] C7			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4060] 47			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 47CF				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [403E] CF			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4061] 47			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 47D8				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [403F] D8			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4062] 47			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 47EF				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4040] EF			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4063] 47			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 4809				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4041] 09			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4064] 48			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 4834				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4042] 34			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4065] 48			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 4839				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4043] 39			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4066] 48			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    52 = 483D				?TMP = .GET[PLTRC+#] + .GET[PHTRC+#]<<8
    52  [4044] 3D			.PUT[PLTRC+#] = .LO(?TMP+OFSET)
    52  [4067] 48			.PUT[PHTRC+#] = .HI(?TMP+OFSET)
    66 = 0004				skip=4
    70 = 4841				?TMP = .GET[PTLST+#*SKIP+2] + .GET[PTLST+#*SKIP+3]<<8
    70  [489B] 41			.PUT[PTLST+#*SKIP+2] = .LO(?TMP+OFSET)
    70  [489C] 48			.PUT[PTLST+#*SKIP+3] = .HI(?TMP+OFSET)
    31 489D			_end
    32 					.print '$R RMT     ',main.RMT_MODUL,'..',main.RMT_MODUL+len-6," 'assets\bootup.rmt'"
    32 				$R RMT     $4000..$489D 'assets\bootup.rmt'
Source: dli_vbl.a65
   104 				.endl
   105
   106 				; ------------------------------------------------------------
   107
   108 489D				org CODEORIGIN
   109
   110 2000				STATICDATA
Macro: STATICDATA [Source: dli_vbl.a65]
     1 2000-2732> 23 20 20 20 + .by  $23 $20 $20 $20 $52 $4D $54 $2D  $44 $4C $2D $56 $42 $4C $2D $44  $4C $49 $20 $77 $69 $74 $68 $20
     2 2018 4D 41 44 20 50 61 + .by  $4D $41 $44 $20 $50 $61 $73 $63  $61 $6C $20 $20 $00 $23 $4E $54  $53 $43 $20 $2F $20 $50 $41 $4C
     3 2030 20 64 65 74 65 63 + .by  $20 $64 $65 $74 $65 $63 $74 $20  $66 $6F $72 $20 $63 $6F $72 $72  $65 $63 $74 $20 $6D $75 $73 $69
     4 2048 63 00 08 70 6C 61 + .by  $63 $00 $08 $70 $6C $61 $79 $62  $61 $63 $6B $00 $21 $59 $6F $75  $20 $63 $61 $6E $20 $70 $75 $74
     5 2060 20 74 65 78 74 20 + .by  $20 $74 $65 $78 $74 $20 $74 $6F  $20 $73 $63 $72 $65 $65 $6E $20  $73 $69 $6D $70 $6C $65 $00 $22
     6 2078 77 72 69 74 65 20 + .by  $77 $72 $69 $74 $65 $20 $2F $20  $77 $72 $69 $74 $65 $6C $6E $20  $63 $6F $6D $6D $61 $6E $64 $73
     7 2090 20 6F 66 20 50 61 + .by  $20 $6F $66 $20 $50 $61 $73 $63  $61 $6C $00 $23 $2D $2D $2D $2D  $2D $2D $2D $2D $2D $2D $2D $70
     8 20A8 72 65 73 73 20 61 + .by  $72 $65 $73 $73 $20 $61 $20 $6B  $65 $79 $20 $2D $2D $2D $2D $2D  $2D $2D $2D $2D $2D $2D $2D $00
     9 20C0 24 30 20 2D 20 20 + .by  $24 $30 $20 $2D $20 $20 $20 $20  $20 $20 $64 $69 $66 $66 $65 $72  $65 $6E $74 $20 $67 $66 $78 $20
    10 20D8 6D 6F 64 65 73 20 + .by  $6D $6F $64 $65 $73 $20 $20 $20  $20 $20 $20 $20 $20 $00 $1F $31  $20 $2D $20 $74 $65 $6E $20 $6C
    11 20F0 69 6E 65 73 20 6F + .by  $69 $6E $65 $73 $20 $6F $66 $20  $67 $66 $78 $20 $30 $20 $61 $74  $20 $24 $38 $30 $30 $30 $00 $1E
    12 2108 32 20 2D 20 69 6E + .by  $32 $20 $2D $20 $69 $6E $68 $65  $72 $69 $74 $20 $62 $79 $20 $73  $6F $6D $65 $20 $6C $69 $6E $65
    13 2120 73 20 77 69 74 68 + .by  $73 $20 $77 $69 $74 $68 $00 $21  $33 $20 $2D $20 $67 $66 $78 $20  $31 $20 $26 $20 $32 $20 $6F $6E
    14 2138 20 64 69 66 66 65 + .by  $20 $64 $69 $66 $66 $65 $72 $65  $6E $74 $20 $73 $63 $72 $65 $65  $6E $00 $0F $34 $20 $2D $20 $6D
    15 2150 65 6D 6F 72 79 20 + .by  $65 $6D $6F $72 $79 $20 $61 $72  $65 $61 $00 $10 $35 $20 $2D $20  $28 $24 $39 $30 $30 $30 $20 $68
    16 2168 65 72 65 29 00 19 + .by  $65 $72 $65 $29 $00 $19 $36 $20  $2D $20 $66 $69 $72 $73 $74 $20  $67 $66 $78 $30 $20 $77 $72 $69
    17 2180 74 65 20 74 68 65 + .by  $74 $65 $20 $74 $68 $65 $6E $00  $20 $37 $20 $2D $20 $63 $68 $61  $6E $67 $65 $20 $38 $38 $20 $74
    18 2198 6F 20 77 72 69 74 + .by  $6F $20 $77 $72 $69 $74 $65 $20  $67 $66 $78 $20 $31 $20 $26 $20  $32 $00 $20 $38 $20 $2D $20 $74
    19 21B0 68 65 6E 20 73 61 + .by  $68 $65 $6E $20 $73 $61 $6D $65  $20 $66 $6F $72 $20 $77 $72 $69  $74 $69 $6E $67 $20 $67 $66 $78
    20 21C8 20 31 32 00 12 39 + .by  $20 $31 $32 $00 $12 $39 $20 $2D  $20 $6E $65 $61 $74 $2C $20 $69  $73 $6E $74 $20 $69 $74 $3F $00
    21 21E0 14 20 20 20 48 45 + .by  $14 $20 $20 $20 $48 $45 $72 $65  $20 $57 $65 $20 $47 $4F $20 $20  $20 $20 $20 $20 $20 $00 $12 $20
    22 21F8 20 20 48 45 72 65 + .by  $20 $20 $48 $45 $72 $65 $20 $57  $65 $20 $47 $4F $20 $20 $20 $20  $20 $00 $14 $20 $21 $21 $48 $45
    23 2210 72 65 20 57 65 20 + .by  $72 $65 $20 $57 $65 $20 $47 $4F  $21 $21 $20 $20 $20 $20 $20 $00  $24 $2D $2D $2D $2D $2D $2D $2D
    24 2228 2D 2D 2D 2D 2D 2D + .by  $2D $2D $2D $2D $2D $2D $2D $2D  $2D $2D $2D $2D $2D $2D $2D $2D  $2D $2D $2D $2D $2D $2D $2D $2D
    25 2240 2D 2D 2D 2D 2D 00 + .by  $2D $2D $2D $2D $2D $00 $1E $20  $20 $20 $20 $20 $67 $66 $78 $20  $31 $32 $20 $69 $73 $20 $68 $61
    26 2258 72 64 20 74 6F 20 + .by  $72 $64 $20 $74 $6F $20 $72 $65  $61 $64 $20 $3A $29 $00 $1E $20  $20 $20 $20 $20 $62 $65 $74 $74
    27 2270 65 72 20 75 73 65 + .by  $65 $72 $20 $75 $73 $65 $20 $61  $20 $73 $70 $65 $63 $69 $61 $6C  $20 $66 $6F $6E $74 $00 $24 $2D
    28 2288 2D 2D 2D 2D 2D 2D + .by  $2D $2D $2D $2D $2D $2D $2D $2D  $2D $2D $2D $2D $4B $45 $59 $2D  $2D $45 $58 $49 $54 $53 $2D $2D
    29 22A0 2D 2D 2D 2D 2D 2D + .by  $2D $2D $2D $2D $2D $2D $2D $2D  $2D $2D $2D $00 $F0 $70 $70 $42  $40 $BC $40 $02 $02 $02 $02 $02
    30 22B8 02 02 02 02 02 02 + .by  $02 $02 $02 $02 $02 $02 $02 $02  $02 $02 $02 $02 $02 $02 $02 $02  $02 $02 $02 $41 $AC $22 $70 $70
    31 22D0 70 42 00 80 70 70 + .by  $70 $42 $00 $80 $70 $70 $70 $02  $02 $02 $02 $46 $00 $90 $06 $07  $06 $06 $42 $C8 $80 $02 $02 $02
    32 22E8 70 44 00 84 04 04 + .by  $70 $44 $00 $84 $04 $04 $04 $70  $42 $68 $81 $41 $CE $22
Source: dli_vbl.a65
   111
   112 				; ------------------------------------------------------------
   113
   114 22F6			RTLIB
   115 22F6				icl 'rtl6502_a8.asm'
Source: rtl6502_a8.asm
   151 					opt l+
   116
   117 				.print 'ZPAGE: ',fxptr,'..',zpend-1
   117 				ZPAGE: $0080..$00D7
   118
   119 				.print 'RTLIB: ',RTLIB,'..',*-1
   119 				RTLIB: $22F6..$2355
   120
   121 				; ------------------------------------------------------------
   122
   123 2356			START
   124 2356 BA				tsx
   125 2357 8E 18 27			stx MAIN.@halt+1
   126
   127 					.ifdef fmulinit
   128 					fmulinit
   129 					eif
   130
   131 = 0029			VLEN	= VARDATASIZE-VARINITSIZE
   132 = 273A			VADR	= DATAORIGIN+VARINITSIZE
   133
   134 					ift VADR > $BFFF
   135 					ert 'Invalid memory address range ',VADR
   136 					eli (VLEN>0) && (VLEN<=256)
   137 235A A2 D7			ldx #256-VLEN
   138 235C A9 00			lda #$00
   139 235E 9D 63 26 E8 D0 FA		sta:rne VADR+VLEN-256,x+
   140 					eli VLEN>256
   141 					@fill #VADR #VLEN #$00
   142 					eif
   143
   144 2364 A9 63 85 82 A9 27 + 	mwa #PROGRAMSTACK psptr
   145
   146 					.ifdef MAIN.@DEFINES.ROMOFF
   147 					icl 'atari\romoff.asm'
   148 					.endif
   149
   150 236C A2 0F			ldx #$0F					; DOS II+/D ParamStr
   151 236E BD 40 03 9D 1D 27 + 	mva:rpl $340,x MAIN.IOCB@COPY,x-
   152
   153 2377 E8				inx						; X = 0
   154 2378 86 84			stx bp						; BP = 0
   155
   156 237A 8E 0F D2			stx skctl					; reset POKEY
   157 237D A9 03			lda #3
   158 237F 8D 0F D2			sta skctl
   159
   160 2382 CA				dex						; X = 255
   161
   162 2383				UNITINITIALIZATION
Macro: UNITINITIALIZATION [Source: dli_vbl.a65]
    19 2383 20 DD 24			jsr MAIN.RMT.@UnitInit
   163
   164 2386			.local	MAIN						; PROCEDURE
   165
   166 2386 4C 1E 25			jmp l_02B3
   167
   168 				; ------------------------------------------------------------
   169
   170 2389			.local	SYSTEM						; UNIT
   171
   172 2389			.local	POKE						; PROCEDURE | ASSEMBLER | REGISTER
   173
   174 				; ------------------------------------------------------------
   175
   176 				; Generate Assignment for BYTE / CHAR / SHORTINT / BOOLEAN
   177 				; as Pointer
   178 2389 B5 98			lda :STACKORIGIN,x
   179 238B 85 90			sta VALUE
   180 238D CA				dex
   181
   182 				; ------------------------------------------------------------
   183
   184 				; Generate Assignment for WORD / SMALLINT / SHORTREAL / POINTER
   185 				; as Pointer
   186 238E B5 98			lda :STACKORIGIN,x
   187 2390 85 8C			sta A
   188 2392 B5 A8			lda :STACKORIGIN+STACKWIDTH,x
   189 2394 85 8D			sta A+1
   190 2396 CA				dex
   191
   192 				; ---------------------  ASM Block 017  ---------------------
   193
   194 2397 A0 00			ldy #0
   195 2399 A5 90 91 8C			mva value (edx),y
   196
   197
   198 				; ------------------------------------------------------------
   199
   200 = 008C			A	= edx
   201 = 0090			VALUE	= ecx
   202 239D			@exit
   203 					.ifdef @new
   204 					lda <@VarData
   205 					sta :ztmp
   206 					lda >@VarData
   207 					ldy #@VarDataSize-1
   208 					jmp @FreeMem
   209 					els
   210 239D 60				rts						; ret
   211 					eif
   212 				.endl
   213
   214 239E			.local	DPOKE						; PROCEDURE | ASSEMBLER | REGISTER
   215
   216 				; ------------------------------------------------------------
   217
   218 				; Generate Assignment for WORD / SMALLINT / SHORTREAL / POINTER
   219 				; as Pointer
   220 239E B5 98			lda :STACKORIGIN,x
   221 23A0 85 90			sta VALUE
   222 23A2 B5 A8			lda :STACKORIGIN+STACKWIDTH,x
   223 23A4 85 91			sta VALUE+1
   224 23A6 CA				dex
   225
   226 				; ------------------------------------------------------------
   227
   228 				; Generate Assignment for WORD / SMALLINT / SHORTREAL / POINTER
   229 				; as Pointer
   230 23A7 B5 98			lda :STACKORIGIN,x
   231 23A9 85 8C			sta A
   232 23AB B5 A8			lda :STACKORIGIN+STACKWIDTH,x
   233 23AD 85 8D			sta A+1
   234 23AF CA				dex
   235
   236 				; ---------------------  ASM Block 018  ---------------------
   237
   238 23B0 A0 00			ldy #0
   239 23B2 A5 90 91 8C			mva value (edx),y
   240 23B6 C8				iny
   241 23B7 A5 91 91 8C			mva value+1 (edx),y
   242
   243
   244 				; ------------------------------------------------------------
   245
   246 = 008C			A	= edx
   247 = 0090			VALUE	= ecx
   248 23BB			@exit
   249 					.ifdef @new
   250 					lda <@VarData
   251 					sta :ztmp
   252 					lda >@VarData
   253 					ldy #@VarDataSize-1
   254 					jmp @FreeMem
   255 					els
   256 23BB 60				rts						; ret
   257 					eif
   258 				.endl
   259
   260 				; ------------------------------------------------------------
   261
   262 = 0101			__PORTB_BANKS	= $0101
   263 = 0648			M_PI_2	= $0648
   264 = 0192			D_PI_2	= $0192
   265 = 0004			D_PI_180	= $04
   266 = 0000			MGTIA	= $00
   267 = 0080			MVBXE	= $80
   268 = 0000			VBXE_XDLADR	= $00
   269 = 0100			VBXE_BCBADR	= $0100
   270 = 1000			VBXE_MAPADR	= $1000
   271 = 1000			VBXE_CHBASE	= $1000
   272 = 5000			VBXE_OVRADR	= $5000
   273 = B000			VBXE_WINDOW	= $B000
   274 = 0000			IDLI	= $00
   275 = 0001			IVBL	= $01
   276 = 0002			ITIM1	= $02
   277 = 0003			ITIM2	= $03
   278 = 0004			ITIM4	= $04
   279 = 00FE			CH_DELCHR	= $FE
   280 = 009B			CH_ENTER	= $9B
   281 = 001B			CH_ESC	= $1B
   282 = 001C			CH_CURS_UP	= $1C
   283 = 001D			CH_CURS_DOWN	= $1D
   284 = 001E			CH_CURS_LEFT	= $1E
   285 = 001F			CH_CURS_RIGHT	= $1F
   286 = 007F			CH_TAB	= $7F
   287 = 009B			CH_EOL	= $9B
   288 = 007D			CH_CLR	= $7D
   289 = 00FD			CH_BELL	= $FD
   290 = 007E			CH_DEL	= $7E
   291 = 009C			CH_DELLINE	= $9C
   292 = 009D			CH_INSLINE	= $9D
   293 = 0000			COLOR_BLACK	= $00
   294 = 000E			COLOR_WHITE	= $0E
   295 = 0032			COLOR_RED	= $32
   296 = 0096			COLOR_CYAN	= $96
   297 = 0068			COLOR_VIOLET	= $68
   298 = 00C4			COLOR_GREEN	= $C4
   299 = 0074			COLOR_BLUE	= $74
   300 = 00EE			COLOR_YELLOW	= $EE
   301 = 0028			COLOR_ORANGE	= $28
   302 = 00E4			COLOR_BROWN	= $E4
   303 = 003C			COLOR_LIGHTRED	= $3C
   304 = 0004			COLOR_GRAY1	= $04
   305 = 0006			COLOR_GRAY2	= $06
   306 = 000A			COLOR_GRAY3	= $0A
   307 = 00CC			COLOR_LIGHTGREEN	= $CC
   308 = 007C			COLOR_LIGHTBLUE	= $7C
   309 = 0004			FMOPENREAD	= $04
   310 = 0008			FMOPENWRITE	= $08
   311 = 0009			FMOPENAPPEND	= $09
   312 = 000C			FMOPENREADWRITE	= $0C
   313 = 2734			SCREENWIDTH	= DATAORIGIN+$0000
   314 = 2736			SCREENHEIGHT	= DATAORIGIN+$0002
   315 = 2738			DATESEPARATOR	= DATAORIGIN+$0004
   316 = D20A			RND	= $D20A
   317 = 02C0			adr.PALETTE	= $02C0
   318 23BC			.var PALETTE	= adr.PALETTE .word
   319 = D012			adr.HPALETTE	= $D012
   320 23BC			.var HPALETTE	= adr.HPALETTE .word
   321 = 2739			FILEMODE	= DATAORIGIN+$0005
   322 = 273A			GRAPHMODE	= DATAORIGIN+$0006
   323 = 273B			IORESULT	= DATAORIGIN+$0007
   324 = 273C			EOLN	= DATAORIGIN+$0008
   325 = 273D			RNDSEED	= DATAORIGIN+$0009
   326
   327 = 23BC C0 02		PALETTE
   327 = 23BE 12 D0		HPALETTE
   327 				.endl							; UNIT SYSTEM
   328
   329 				; ------------------------------------------------------------
   330
   331 23C0			.local	ATARI						; UNIT
   332
   333 				; ------------------------------------------------------------
   334
   335 = 0010			IRQENS	= $10
   336 = 0012			RTCLOK	= $12
   337 = 004D			ATRACT	= $4D
   338 = 0052			LMARGIN	= $52
   339 = 0053			RMARGIN	= $53
   340 = 0054			ROWCRS	= $54
   341 = 0055			COLCRS	= $55
   342 = 0057			DINDEX	= $57
   343 = 0058			SAVMSC	= $58
   344 = 0062			PALNTS	= $62
   345 = 006A			RAMTOP	= $6A
   346 = 0200			VDSLST	= $0200
   347 = 0230			SDLSTL	= $0230
   348 = 0290			TXTROW	= $0290
   349 = 0291			TXTCOL	= $0291
   350 = 0293			TINDEX	= $0293
   351 = 0294			TXTMSC	= $0294
   352 = 022F			SDMCTL	= $022F
   353 = 026F			GPRIOR	= $026F
   354 = 02F0			CRSINH	= $02F0
   355 = 02F3			CHACT	= $02F3
   356 = 02F4			CHBAS	= $02F4
   357 = 02FC			CH	= $02FC
   358 = 02C0			PCOLR0	= $02C0
   359 = 02C1			PCOLR1	= $02C1
   360 = 02C2			PCOLR2	= $02C2
   361 = 02C3			PCOLR3	= $02C3
   362 = 02C4			COLOR0	= $02C4
   363 = 02C5			COLOR1	= $02C5
   364 = 02C6			COLOR2	= $02C6
   365 = 02C7			COLOR3	= $02C7
   366 = 02C8			COLOR4	= $02C8
   367 = 02C8			COLBAKS	= $02C8
   368 = D000			HPOSP0	= $D000
   369 = D001			HPOSP1	= $D001
   370 = D002			HPOSP2	= $D002
   371 = D003			HPOSP3	= $D003
   372 = D004			HPOSM0	= $D004
   373 = D005			HPOSM1	= $D005
   374 = D006			HPOSM2	= $D006
   375 = D007			HPOSM3	= $D007
   376 = D008			SIZEP0	= $D008
   377 = D009			SIZEP1	= $D009
   378 = D00A			SIZEP2	= $D00A
   379 = D00B			SIZEP3	= $D00B
   380 = D00C			SIZEM	= $D00C
   381 = D00D			GRAFP0	= $D00D
   382 = D00E			GRAFP1	= $D00E
   383 = D00F			GRAFP2	= $D00F
   384 = D010			GRAFP3	= $D010
   385 = D011			GRAFM	= $D011
   386 = D004			P0PF	= $D004
   387 = D014			PAL	= $D014
   388 = D012			COLPM0	= $D012
   389 = D013			COLPM1	= $D013
   390 = D014			COLPM2	= $D014
   391 = D015			COLPM3	= $D015
   392 = D016			COLPF0	= $D016
   393 = D017			COLPF1	= $D017
   394 = D018			COLPF2	= $D018
   395 = D019			COLPF3	= $D019
   396 = D01A			COLBK	= $D01A
   397 = D01B			PRIOR	= $D01B
   398 = D01D			GRACTL	= $D01D
   399 = D01E			HITCLR	= $D01E
   400 = D01F			CONSOL	= $D01F
   401 = D200			AUDF1	= $D200
   402 = D201			AUDC1	= $D201
   403 = D202			AUDF2	= $D202
   404 = D203			AUDC2	= $D203
   405 = D204			AUDF3	= $D204
   406 = D205			AUDC3	= $D205
   407 = D206			AUDF4	= $D206
   408 = D207			AUDC4	= $D207
   409 = D208			AUDCTL	= $D208
   410 = D209			KBCODE	= $D209
   411 = D20E			IRQEN	= $D20E
   412 = D20F			SKSTAT	= $D20F
   413 = D300			PORTA	= $D300
   414 = D301			PORTB	= $D301
   415 = D400			DMACTL	= $D400
   416 = D401			CHACTL	= $D401
   417 = D402			DLISTL	= $D402
   418 = D404			HSCROL	= $D404
   419 = D405			VSCROL	= $D405
   420 = D407			PMBASE	= $D407
   421 = D409			CHBASE	= $D409
   422 = D40A			WSYNC	= $D40A
   423 = D40B			VCOUNT	= $D40B
   424 = D40C			PENH	= $D40C
   425 = D40D			PENV	= $D40D
   426 = D40E			NMIEN	= $D40E
   427 = FFFA			NMIVEC	= $FFFA
   428 = FFFC			RESETVEC	= $FFFC
   429 = FFFE			IRQVEC	= $FFFE
   430
   431 				.endl							; UNIT ATARI
   432
   433 				; ------------------------------------------------------------
   434
   435 23C0			.local	CRT						; UNIT
   436
   437 23C0			.local	CLRSCR						; PROCEDURE
   438
   439 				; optimize FAIL ('@print', CRT), line = 150
   440
   441 					@print #$7D
   441 				 LDY# $7D\ JSR @PRINT
   441 23C0 A0 7D		 LDY# $7D
   441 23C2 20 1E 23		 JSR @PRINT
   442 23C5			@exit
   443 					.ifdef @new
   444 					lda <@VarData
   445 					sta :ztmp
   446 					lda >@VarData
   447 					ldy #@VarDataSize-1
   448 					jmp @FreeMem
   449 					els
   450 23C5 60				rts						; ret
   451 					eif
   452 				.endl
   453
   454 23C6			.local	READKEY						; FUNCTION | ASSEMBLER
   455
   456 				; ---------------------  ASM Block 050  ---------------------
   457
   458 23C6				m@call @GetKey
Macro: M@CALL [Source: macros.asm]
    12 23C6 20 F6 22				jsr @GETKEY
Source: dli_vbl.a65
   459 23C9 8D 40 27			sta Result
   460
   461 23CC			@exit
   462
   463 				; ------------------------------------------------------------
   464
   465 				; Push BYTE / CHAR / SHORTINT / BOOLEAN
   466 				; as Pointer
   467
   468 23CC E8				inx
   469 23CD AD 40 27 95 98		mva RESULT :STACKORIGIN,x
   470
   471 					.ifdef @new
   472 					lda <@VarData
   473 					sta :ztmp
   474 					lda >@VarData
   475 					ldy #@VarDataSize-1
   476 					jmp @FreeMem
   477 					eif
   478
   479 				; ------------------------------------------------------------
   480
   481 = 2740			RESULT	= DATAORIGIN+$000C
   482
   483 = 2740			@VarData	= RESULT
   484 = 0001			@VarDataSize	= 1
   485
   486 23D2 60				rts						; ret
   487 				.endl
   488
   489 23D3			.local	KEYPRESSED					; FUNCTION | ASSEMBLER
   490
   491 				; ---------------------  ASM Block 054  ---------------------
   492
   493 23D3 A0 00			ldy #$00	; false
   494 23D5 AD FC 02			lda kbcodes
   495 23D8 C9 FF			cmp #$ff
   496 23DA F0 01			beq skp
   497 23DC C8				iny		; true
   498
   499 				;	sty kbcodes
   500
   501 23DD 8C 41 27		skp	sty Result
   502
   503 23E0			@exit
   504
   505 				; ------------------------------------------------------------
   506
   507 				; Push BYTE / CHAR / SHORTINT / BOOLEAN
   508 				; as Pointer
   509
   510 23E0 E8				inx
   511 23E1 AD 41 27 95 98		mva RESULT :STACKORIGIN,x
   512
   513 					.ifdef @new
   514 					lda <@VarData
   515 					sta :ztmp
   516 					lda >@VarData
   517 					ldy #@VarDataSize-1
   518 					jmp @FreeMem
   519 					eif
   520
   521 				; ------------------------------------------------------------
   522
   523 = 2741			RESULT	= DATAORIGIN+$000D
   524
   525 = 2741			@VarData	= RESULT
   526 = 0001			@VarDataSize	= 1
   527
   528 23E6 60				rts						; ret
   529 				.endl
   530
   531 				; ------------------------------------------------------------
   532
   533 = 273F			TEXTATTR	= DATAORIGIN+$000B
   534 = D01F			CONSOL	= $D01F
   535 = 0000			CN_START_SELECT_OPTION	= $00
   536 = 0001			CN_SELECT_OPTION	= $01
   537 = 0002			CN_START_OPTION	= $02
   538 = 0003			CN_OPTION	= $03
   539 = 0004			CN_START_SELECT	= $04
   540 = 0005			CN_SELECT	= $05
   541 = 0006			CN_START	= $06
   542 = 0007			CN_NONE	= $07
   543 = 0000			BW40	= $00
   544 = 0001			CO40	= $01
   545 = 0002			BW80	= $02
   546 = 0003			CO80	= $03
   547 = 0007			MONO	= $07
   548 = 0001			C40	= $01
   549 = 0003			C80	= $03
   550 = 0000			BLACK	= $00
   551 = 0001			BLUE	= $01
   552 = 0002			GREEN	= $02
   553 = 0003			CYAN	= $03
   554 = 0004			RED	= $04
   555 = 0005			MAGENTA	= $05
   556 = 0006			BROWN	= $06
   557 = 0007			LIGHTGRAY	= $07
   558 = 0008			DARKGRAY	= $08
   559 = 0009			LIGHTBLUE	= $09
   560 = 000A			LIGHTGREEN	= $0A
   561 = 000B			LIGHTCYAN	= $0B
   562 = 000C			LIGHTRED	= $0C
   563 = 000D			LIGHTMAGENTA	= $0D
   564 = 000E			YELLOW	= $0E
   565 = 000F			WHITE	= $0F
   566 = 0080			BLINK	= $80
   567
   568 				.endl							; UNIT CRT
   569
   570 				; ------------------------------------------------------------
   571
   572 23E7			.local	MISC						; UNIT
   573
   574 23E7			.local	DETECTANTIC					; FUNCTION | ASSEMBLER
   575
   576 				; ---------------------  ASM Block 061  ---------------------
   577
   578
   579 				// ANTIC PAL Test for Atari 8-bits
   580 				// (C) 2019 Guillermo Fuenzalida
   581
   582 23E7			antic_loop1
   583 23E7 AD 0B D4			lda vcount
   584 23EA C9 64			cmp #100
   585 23EC 90 F9			bcc antic_loop1		// wait till scanline 200
   586 23EE 8D 05 24			sta scanline
   587 23F1			antic_loop2
   588 23F1 AD 0B D4			lda vcount
   589 23F4 C9 0A			cmp #10
   590 23F6 30 0A			bmi antic_loop2_fin
   591 23F8 CD 05 24			cmp scanline
   592 23FB 30 F4			bmi antic_loop2
   593 23FD 8D 05 24			sta scanline
   594 2400 10 EF			bpl antic_loop2
   595
   596 2402			antic_loop2_fin
   597 2402 A0 00			ldy #$00
   598 2404 A9 00			lda #0
   599 = 2405			scanline equ *-1
   600 2406 C9 87			cmp #135
   601 2408 30 01			bmi ntsc
   602 240A C8				iny
   603 240B			ntsc
   604 240B 8C 42 27			sty Result
   605
   606 240E			@exit
   607
   608 				; ------------------------------------------------------------
   609
   610 				; Push BYTE / CHAR / SHORTINT / BOOLEAN
   611 				; as Pointer
   612
   613 240E E8				inx
   614 240F AD 42 27 95 98		mva RESULT :STACKORIGIN,x
   615
   616 					.ifdef @new
   617 					lda <@VarData
   618 					sta :ztmp
   619 					lda >@VarData
   620 					ldy #@VarDataSize-1
   621 					jmp @FreeMem
   622 					eif
   623
   624 				; ------------------------------------------------------------
   625
   626 = 2742			RESULT	= DATAORIGIN+$000E
   627
   628 = 2742			@VarData	= RESULT
   629 = 0001			@VarDataSize	= 1
   630
   631 2414 60				rts						; ret
   632 				.endl
   633
   634 				; ------------------------------------------------------------
   635
   636 = 0101			adr.BANKS	= $0101
   637 2415			.var BANKS	= adr.BANKS .word
   638 = FFF7			DETECTOS	= $FFF7
   639
   640 = 2415 01 01		BANKS
   640 				.endl							; UNIT MISC
   641
   642 				; ------------------------------------------------------------
   643
   644 2417			.local	RMT						; UNIT
   645
   646 2417			.local	TRMT.INIT					; PROCEDURE | ASSEMBLER
   647 2417 8D 44 27			sta TRMT
   648 241A 8C 45 27			sty TRMT+1
   649 241D 8D 47 27			sta PLAYER
   650 2420 8C 48 27			sty PLAYER+1
   651 2423 18 69 02			add #2
   652 2426 90 01			scc
   653 2428 C8				iny
   654 2429 8D 49 27			sta MODUL
   655 242C 8C 4A 27			sty MODUL+1
   656
   657 				; ---------------------  ASM Block 071  ---------------------
   658
   659 242F 8A 48			txa:pha
   660
   661 2431 AD 44 27 85 86 AD + 	mwa TRMT :bp2
   662
   663 243B A0 00			ldy #0
   664 243D B1 86			lda (:bp2),y
   665 243F 18 69 03			add #3		; jsr player+3
   666 2442 8D 59 24			sta adr
   667 2445 C8				iny
   668 2446 B1 86			lda (:bp2),y
   669 2448 69 00			adc #0
   670 244A 8D 5A 24			sta adr+1
   671
   672 244D C8				iny
   673 244E B1 86			lda (:bp2),y
   674 2450 AA				tax		; low byte of RMT module to X reg
   675 2451 C8				iny
   676 2452 B1 86			lda (:bp2),y
   677 2454 A8				tay		; hi byte of RMT module to Y reg
   678
   679 2455 AD 46 27			lda a		; starting song line 0-255 to A reg
   680 2458 20 FF FF			jsr $ffff
   681 = 2459			adr	equ *-2
   682
   683 245B 68 AA			pla:tax
   684
   685
   686 				; ------------------------------------------------------------
   687
   688 = 2744			TRMT	= DATAORIGIN+$0010
   689 = 2746			A	= DATAORIGIN+$0012
   690 = 2747			PLAYER	= DATAORIGIN+$0013
   691 = 2749			MODUL	= DATAORIGIN+$0015
   692
   693 = 2744			@VarData	= TRMT
   694 = 0007			@VarDataSize	= 7
   695
   696 245D			@exit
   697 					.ifdef @new
   698 					lda <@VarData
   699 					sta :ztmp
   700 					lda >@VarData
   701 					ldy #@VarDataSize-1
   702 					jmp @FreeMem
   703 					els
   704 245D 60				rts						; ret
   705 					eif
   706 				.endl
   707
   708 245E			.local	TRMT.PLAY					; PROCEDURE | ASSEMBLER
   709 245E 8D 4F 27			sta TRMT
   710 2461 8C 50 27			sty TRMT+1
   711 2464 8D 51 27			sta PLAYER
   712 2467 8C 52 27			sty PLAYER+1
   713 246A 18 69 02			add #2
   714 246D 90 01			scc
   715 246F C8				iny
   716 2470 8D 53 27			sta MODUL
   717 2473 8C 54 27			sty MODUL+1
   718
   719 				; ---------------------  ASM Block 073  ---------------------
   720
   721 2476 8A 48			txa:pha
   722
   723 2478 0E 43 27			asl ntsc		; =0 PAL, =4 NTSC
   724 247B 90 07			bcc skp
   725
   726 247D A9 04			lda #%00000100
   727 247F 8D 43 27			sta ntsc
   728
   729 2482 D0 1A			bne quit
   730 2484			skp
   731 2484 AD 4F 27 8D 93 24 + 	mwa TRMT adr
   732
   733 2490 A0 01			ldy #1
   734 2492 B9 00 FF		mov	lda $ff00,y
   735 = 2493			adr	equ *-2
   736 2495 99 9C 24			sta ptr,y
   737 2498 88				dey
   738 2499 10 F7			bpl mov
   739
   740 249B 20 00 FF			jsr $ff00		; jmp (TRMT)	6502 buggy indirect jump
   741 = 249C			ptr	equ *-2
   742
   743 249E 68 AA		quit	pla:tax
   744
   745
   746 				; ------------------------------------------------------------
   747
   748 = 274F			TRMT	= DATAORIGIN+$001B
   749 = 2751			PLAYER	= DATAORIGIN+$001D
   750 = 2753			MODUL	= DATAORIGIN+$001F
   751
   752 = 274F			@VarData	= TRMT
   753 = 0006			@VarDataSize	= 6
   754
   755 24A0			@exit
   756 					.ifdef @new
   757 					lda <@VarData
   758 					sta :ztmp
   759 					lda >@VarData
   760 					ldy #@VarDataSize-1
   761 					jmp @FreeMem
   762 					els
   763 24A0 60				rts						; ret
   764 					eif
   765 				.endl
   766
   767 24A1			.local	TRMT.STOP					; PROCEDURE | ASSEMBLER
   768 24A1 8D 55 27			sta TRMT
   769 24A4 8C 56 27			sty TRMT+1
   770 24A7 8D 57 27			sta PLAYER
   771 24AA 8C 58 27			sty PLAYER+1
   772 24AD 18 69 02			add #2
   773 24B0 90 01			scc
   774 24B2 C8				iny
   775 24B3 8D 59 27			sta MODUL
   776 24B6 8C 5A 27			sty MODUL+1
   777
   778 				; ---------------------  ASM Block 074  ---------------------
   779
   780 24B9 8A 48			txa:pha
   781
   782 24BB AD 55 27 85 86 AD + 	mwa TRMT :bp2
   783
   784 24C5 A0 00			ldy #0
   785 24C7 B1 86			lda (:bp2),y
   786 24C9 18 69 09			add #9		; jsr player+9
   787 24CC 8D D8 24			sta adr
   788 24CF C8				iny
   789 24D0 B1 86			lda (:bp2),y
   790 24D2 69 00			adc #0
   791 24D4 8D D9 24			sta adr+1
   792
   793 24D7 20 FF FF			jsr $ffff
   794 = 24D8			adr	equ *-2
   795
   796 24DA 68 AA			pla:tax
   797
   798
   799 				; ------------------------------------------------------------
   800
   801 = 2755			TRMT	= DATAORIGIN+$0021
   802 = 2757			PLAYER	= DATAORIGIN+$0023
   803 = 2759			MODUL	= DATAORIGIN+$0025
   804
   805 = 2755			@VarData	= TRMT
   806 = 0006			@VarDataSize	= 6
   807
   808 24DC			@exit
   809 					.ifdef @new
   810 					lda <@VarData
   811 					sta :ztmp
   812 					lda >@VarData
   813 					ldy #@VarDataSize-1
   814 					jmp @FreeMem
   815 					els
   816 24DC 60				rts						; ret
   817 					eif
   818 				.endl
   819
   820 				; ------------------------------------------------------------
   821 				; ------------------------------------------------------------
   822 24DD			@UnitInit
   823
   824 				; optimize FAIL ('MISC.DETECTANTIC', RMT), line = 183
   825
   826 24DD 20 E7 23			jsr MISC.DETECTANTIC
   827 24E0 CA				dex
   828 24E1 B5 99			lda :STACKORIGIN+1,x
   829 24E3 F0 08			jeq l_033E
   830
   831 				; optimize OK (RMT), line = 184
   832
   833 24E5 A9 00			lda #$00
   834 24E7 8D 43 27			sta NTSC
   835 24EA 4C F2 24			jmp l_034C
   836 24ED			l_033E
   837
   838 				; optimize OK (RMT), line = 186
   839
   840 24ED A9 04			lda #$04
   841 24EF 8D 43 27			sta NTSC
   842 24F2			l_034C
   843
   844 24F2 60				rts
   845
   846 				; ------------------------------------------------------------
   847
   848 = 2743			NTSC	= DATAORIGIN+$000F
   849
   850 				.endl							; UNIT RMT
   851
   852 24F3			.local	VBL						; PROCEDURE | INTERRUPT
   853
   854 				; optimize FAIL ('RMT.TRMT.PLAY', dli_vbl.pas), line = 44
   855
   856 24F3 AD 31 27			lda MSX
   857 24F6 AC 32 27			ldy MSX+1
   858 24F9 20 5E 24			jsr RMT.TRMT.PLAY
   859
   860 				; ---------------------  ASM Block 075  ---------------------
   861
   862
   863 24FC 4C 62 E4			jmp xitvbv
   864
   865 24FF 40				rti						; ret
   866 				.endl
   867
   868 2500			.local	DLI_BS						; PROCEDURE | INTERRUPT
   869
   870 				; ---------------------  ASM Block 076  ---------------------
   871
   872 2500 48 8A 48 98 48		phr
   873
   874 2505 A2 00			ldx #$0
   875 2507			lp
   876 2507 8E 1A D0			stx colbak
   877 250A 8A				txa
   878 250B 29 82			and #$82
   879 250D 8D 18 D0			sta color2
   880 2510 8E 0A D4			stx wsync
   881 2513 E8				inx
   882 2514 E0 E0			cpx #$e0
   883 2516 D0 EF			bne lp
   884
   885 2518 68 A8 68 AA 68		plr
   886
   887 251D 40				rti						; ret
   888 				.endl
   889 251E			l_02B3
   890
   891 251E AD 00 02			lda VDSLST
   892 2521 8D 5F 27			sta OLD_DLI
   893 2524 AD 01 02			lda VDSLST+1
   894 2527 8D 60 27			sta OLD_DLI+1
   895
   896 252A AD 24 02			lda VVBLKD
   897 252D 8D 61 27			sta OLD_VBL
   898 2530 AD 25 02			lda VVBLKD+1
   899 2533 8D 62 27			sta OLD_VBL+1
   900
   901 				; optimize OK (dli_vbl.pas), line = 79
   902
   903 2536 A9 AC			lda #$AC
   904 2538 8D 30 02			sta $0230
   905 253B A9 22			lda #$22
   906 253D 8D 31 02			sta $0230+1
   907
   908 				; optimize OK (dli_vbl.pas), line = 81
   909
   910 2540 A9 00			lda #$00
   911 2542 8D 5B 27			sta MSX.PLAYER
   912 2545 A9 A0			lda #$A0
   913 2547 8D 5C 27			sta MSX.PLAYER+1
   914
   915 				; optimize OK (dli_vbl.pas), line = 82
   916
   917 254A A9 00			lda #$00
   918 254C 8D 5D 27			sta MSX.MODUL
   919 254F A9 40			lda #$40
   920 2551 8D 5E 27			sta MSX.MODUL+1
   921
   922 				; optimize OK (dli_vbl.pas), line = 84
   923
   924 2554 A9 00			lda #$00
   925 2556 8D 46 27			sta RMT.TRMT.INIT.A
   926 2559 AD 31 27			lda MSX
   927 255C AC 32 27			ldy MSX+1
   928 255F 20 17 24			jsr RMT.TRMT.INIT
   929
   930 				; optimize OK (dli_vbl.pas), line = 86
   931
   932 2562 A9 F3			lda <VBL
   933 2564 A0 05			ldy #5
   934 2566 8D 0A D4			sta wsync
   935 2569 88				dey
   936 256A D0 FD			rne
   937 256C 8D 24 02			sta VVBLKD
   938 256F A9 24			lda >VBL
   939 2571 8D 25 02			sta VVBLKD+1
   940
   941 				; optimize OK (dli_vbl.pas), line = 88
   942
   943 2574 A9 00 8D 00 02		mva <DLI_BS VDSLST
   944 2579 A9 25 8D 01 02		mva >DLI_BS VDSLST+1
   945
   946 				; optimize OK (dli_vbl.pas), line = 90
   947
   948 257E A9 C0			lda #$C0
   949 2580 8D 0E D4			sta $D40E
   950
   951 				; optimize FAIL ('@print', dli_vbl.pas), line = 92
   952
   953 					@printSTRING #CODEORIGIN+$0000
   953 				 LDY> CODEORIGIN+$0000\ LDA< CODEORIGIN+$0000\ JSR @PRINTSTRING
   953 2583 A0 20		 LDY> CODEORIGIN+$0000
   953 2585 A9 00		 LDA< CODEORIGIN+$0000
   953 2587 20 27 23		 JSR @PRINTSTRING
   954 258A 20 19 23			@printEOL
   955
   956 				; optimize FAIL ('@print', dli_vbl.pas), line = 93
   957
   958 					@printSTRING #CODEORIGIN+$0025
   958 				 LDY> CODEORIGIN+$0025\ LDA< CODEORIGIN+$0025\ JSR @PRINTSTRING
   958 258D A0 20		 LDY> CODEORIGIN+$0025
   958 258F A9 25		 LDA< CODEORIGIN+$0025
   958 2591 20 27 23		 JSR @PRINTSTRING
   959 2594 20 19 23			@printEOL
   960
   961 				; optimize FAIL ('@print', dli_vbl.pas), line = 94
   962
   963 					@printSTRING #CODEORIGIN+$004A
   963 				 LDY> CODEORIGIN+$004A\ LDA< CODEORIGIN+$004A\ JSR @PRINTSTRING
   963 2597 A0 20		 LDY> CODEORIGIN+$004A
   963 2599 A9 4A		 LDA< CODEORIGIN+$004A
   963 259B 20 27 23		 JSR @PRINTSTRING
   964 259E 20 19 23			@printEOL
   965
   966 				; optimize FAIL ('@print', dli_vbl.pas), line = 95
   967
   968 25A1 20 19 23			@printEOL
   969
   970 				; optimize FAIL ('@print', dli_vbl.pas), line = 96
   971
   972 25A4 20 19 23			@printEOL
   973
   974 				; optimize FAIL ('@print', dli_vbl.pas), line = 97
   975
   976 25A7 20 19 23			@printEOL
   977
   978 				; optimize FAIL ('@print', dli_vbl.pas), line = 98
   979
   980 25AA 20 19 23			@printEOL
   981
   982 				; optimize FAIL ('@print', dli_vbl.pas), line = 99
   983
   984 25AD 20 19 23			@printEOL
   985
   986 				; optimize FAIL ('@print', dli_vbl.pas), line = 100
   987
   988 25B0 20 19 23			@printEOL
   989
   990 				; optimize FAIL ('@print', dli_vbl.pas), line = 101
   991
   992 25B3 20 19 23			@printEOL
   993
   994 				; optimize FAIL ('@print', dli_vbl.pas), line = 102
   995
   996 25B6 20 19 23			@printEOL
   997
   998 				; optimize FAIL ('@print', dli_vbl.pas), line = 103
   999
  1000 25B9 20 19 23			@printEOL
  1001
  1002 				; optimize FAIL ('@print', dli_vbl.pas), line = 104
  1003
  1004 					@printSTRING #CODEORIGIN+$0054
  1004 				 LDY> CODEORIGIN+$0054\ LDA< CODEORIGIN+$0054\ JSR @PRINTSTRING
  1004 25BC A0 20		 LDY> CODEORIGIN+$0054
  1004 25BE A9 54		 LDA< CODEORIGIN+$0054
  1004 25C0 20 27 23		 JSR @PRINTSTRING
  1005 25C3 20 19 23			@printEOL
  1006
  1007 				; optimize FAIL ('@print', dli_vbl.pas), line = 105
  1008
  1009 					@printSTRING #CODEORIGIN+$0077
  1009 				 LDY> CODEORIGIN+$0077\ LDA< CODEORIGIN+$0077\ JSR @PRINTSTRING
  1009 25C6 A0 20		 LDY> CODEORIGIN+$0077
  1009 25C8 A9 77		 LDA< CODEORIGIN+$0077
  1009 25CA 20 27 23		 JSR @PRINTSTRING
  1010 25CD 20 19 23			@printEOL
  1011
  1012 				; optimize FAIL ('@print', dli_vbl.pas), line = 106
  1013
  1014 25D0 20 19 23			@printEOL
  1015
  1016 				; optimize FAIL ('@print', dli_vbl.pas), line = 107
  1017
  1018 25D3 20 19 23			@printEOL
  1019
  1020 				; optimize FAIL ('@print', dli_vbl.pas), line = 108
  1021
  1022 25D6 20 19 23			@printEOL
  1023
  1024 				; optimize FAIL ('@print', dli_vbl.pas), line = 109
  1025
  1026 25D9 20 19 23			@printEOL
  1027
  1028 				; optimize FAIL ('@print', dli_vbl.pas), line = 110
  1029
  1030 25DC 20 19 23			@printEOL
  1031
  1032 				; optimize FAIL ('@print', dli_vbl.pas), line = 111
  1033
  1034 25DF 20 19 23			@printEOL
  1035
  1036 				; optimize FAIL ('@print', dli_vbl.pas), line = 112
  1037
  1038 25E2 20 19 23			@printEOL
  1039
  1040 				; optimize FAIL ('@print', dli_vbl.pas), line = 113
  1041
  1042 25E5 20 19 23			@printEOL
  1043
  1044 				; optimize FAIL ('@print', dli_vbl.pas), line = 114
  1045
  1046 25E8 20 19 23			@printEOL
  1047
  1048 				; optimize FAIL ('@print', dli_vbl.pas), line = 115
  1049
  1050 					@printSTRING #CODEORIGIN+$009B
  1050 				 LDY> CODEORIGIN+$009B\ LDA< CODEORIGIN+$009B\ JSR @PRINTSTRING
  1050 25EB A0 20		 LDY> CODEORIGIN+$009B
  1050 25ED A9 9B		 LDA< CODEORIGIN+$009B
  1050 25EF 20 27 23		 JSR @PRINTSTRING
  1051
  1052 				; --- RepeatUntilProlog
  1053 25F2			l_037C
  1054
  1055 				; optimize FAIL ('CRT.KEYPRESSED', dli_vbl.pas), line = 119
  1056
  1057 25F2 20 D3 23			jsr CRT.KEYPRESSED
  1058 25F5 CA				dex
  1059 25F6 B5 99			lda :STACKORIGIN+1,x
  1060 25F8 F0 F8			jeq l_037C
  1061
  1062 				; optimize OK (dli_vbl.pas), line = 121
  1063
  1064 25FA AD 61 27			lda OLD_VBL
  1065 25FD A0 05			ldy #5
  1066 25FF 8D 0A D4			sta wsync
  1067 2602 88				dey
  1068 2603 D0 FD			rne
  1069 2605 8D 24 02			sta VVBLKD
  1070 2608 AD 62 27			lda OLD_VBL+1
  1071 260B 8D 25 02			sta VVBLKD+1
  1072
  1073 				; optimize OK (dli_vbl.pas), line = 122
  1074
  1075 260E AD 5F 27 8D 00 02		mva OLD_DLI VDSLST
  1076 2614 AD 60 27 8D 01 02		mva OLD_DLI+1 VDSLST+1
  1077
  1078 				; optimize FAIL ('RMT.TRMT.STOP', dli_vbl.pas), line = 124
  1079
  1080 261A AD 31 27			lda MSX
  1081 261D AC 32 27			ldy MSX+1
  1082 2620 20 A1 24			jsr RMT.TRMT.STOP
  1083
  1084 				; optimize FAIL ('CRT.READKEY', dli_vbl.pas), line = 126
  1085
  1086 2623 20 C6 23			jsr CRT.READKEY
  1087 2626 CA				dex
  1088
  1089 				; optimize OK (dli_vbl.pas), line = 128
  1090
  1091 2627 A9 CE			lda #$CE
  1092 2629 8D 30 02			sta $0230
  1093 262C A9 22			lda #$22
  1094 262E 8D 31 02			sta $0230+1
  1095
  1096 				; optimize OK (dli_vbl.pas), line = 131
  1097
  1098 2631 A9 00			lda #$00
  1099 2633 85 58			sta $0058
  1100 2635 A9 80			lda #$80
  1101 2637 85 59			sta $0058+1
  1102
  1103 				; optimize FAIL ('CRT.CLRSCR', dli_vbl.pas), line = 132
  1104
  1105 2639 20 C0 23			jsr CRT.CLRSCR
  1106
  1107 				; optimize FAIL ('@print', dli_vbl.pas), line = 134
  1108
  1109 					@printSTRING #CODEORIGIN+$00C0
  1109 				 LDY> CODEORIGIN+$00C0\ LDA< CODEORIGIN+$00C0\ JSR @PRINTSTRING
  1109 263C A0 20		 LDY> CODEORIGIN+$00C0
  1109 263E A9 C0		 LDA< CODEORIGIN+$00C0
  1109 2640 20 27 23		 JSR @PRINTSTRING
  1110 2643 20 19 23			@printEOL
  1111
  1112 				; optimize FAIL ('@print', dli_vbl.pas), line = 135
  1113
  1114 					@printSTRING #CODEORIGIN+$00E6
  1114 				 LDY> CODEORIGIN+$00E6\ LDA< CODEORIGIN+$00E6\ JSR @PRINTSTRING
  1114 2646 A0 20		 LDY> CODEORIGIN+$00E6
  1114 2648 A9 E6		 LDA< CODEORIGIN+$00E6
  1114 264A 20 27 23		 JSR @PRINTSTRING
  1115 264D 20 19 23			@printEOL
  1116
  1117 				; optimize FAIL ('@print', dli_vbl.pas), line = 136
  1118
  1119 					@printSTRING #CODEORIGIN+$0107
  1119 				 LDY> CODEORIGIN+$0107\ LDA< CODEORIGIN+$0107\ JSR @PRINTSTRING
  1119 2650 A0 21		 LDY> CODEORIGIN+$0107
  1119 2652 A9 07		 LDA< CODEORIGIN+$0107
  1119 2654 20 27 23		 JSR @PRINTSTRING
  1120 2657 20 19 23			@printEOL
  1121
  1122 				; optimize FAIL ('@print', dli_vbl.pas), line = 137
  1123
  1124 					@printSTRING #CODEORIGIN+$0127
  1124 				 LDY> CODEORIGIN+$0127\ LDA< CODEORIGIN+$0127\ JSR @PRINTSTRING
  1124 265A A0 21		 LDY> CODEORIGIN+$0127
  1124 265C A9 27		 LDA< CODEORIGIN+$0127
  1124 265E 20 27 23		 JSR @PRINTSTRING
  1125 2661 20 19 23			@printEOL
  1126
  1127 				; optimize FAIL ('@print', dli_vbl.pas), line = 138
  1128
  1129 					@printSTRING #CODEORIGIN+$014A
  1129 				 LDY> CODEORIGIN+$014A\ LDA< CODEORIGIN+$014A\ JSR @PRINTSTRING
  1129 2664 A0 21		 LDY> CODEORIGIN+$014A
  1129 2666 A9 4A		 LDA< CODEORIGIN+$014A
  1129 2668 20 27 23		 JSR @PRINTSTRING
  1130 266B 20 19 23			@printEOL
  1131
  1132 				; optimize FAIL ('@print', dli_vbl.pas), line = 139
  1133
  1134 					@printSTRING #CODEORIGIN+$015B
  1134 				 LDY> CODEORIGIN+$015B\ LDA< CODEORIGIN+$015B\ JSR @PRINTSTRING
  1134 266E A0 21		 LDY> CODEORIGIN+$015B
  1134 2670 A9 5B		 LDA< CODEORIGIN+$015B
  1134 2672 20 27 23		 JSR @PRINTSTRING
  1135 2675 20 19 23			@printEOL
  1136
  1137 				; optimize FAIL ('@print', dli_vbl.pas), line = 140
  1138
  1139 					@printSTRING #CODEORIGIN+$016D
  1139 				 LDY> CODEORIGIN+$016D\ LDA< CODEORIGIN+$016D\ JSR @PRINTSTRING
  1139 2678 A0 21		 LDY> CODEORIGIN+$016D
  1139 267A A9 6D		 LDA< CODEORIGIN+$016D
  1139 267C 20 27 23		 JSR @PRINTSTRING
  1140 267F 20 19 23			@printEOL
  1141
  1142 				; optimize FAIL ('@print', dli_vbl.pas), line = 141
  1143
  1144 					@printSTRING #CODEORIGIN+$0188
  1144 				 LDY> CODEORIGIN+$0188\ LDA< CODEORIGIN+$0188\ JSR @PRINTSTRING
  1144 2682 A0 21		 LDY> CODEORIGIN+$0188
  1144 2684 A9 88		 LDA< CODEORIGIN+$0188
  1144 2686 20 27 23		 JSR @PRINTSTRING
  1145 2689 20 19 23			@printEOL
  1146
  1147 				; optimize FAIL ('@print', dli_vbl.pas), line = 142
  1148
  1149 					@printSTRING #CODEORIGIN+$01AA
  1149 				 LDY> CODEORIGIN+$01AA\ LDA< CODEORIGIN+$01AA\ JSR @PRINTSTRING
  1149 268C A0 21		 LDY> CODEORIGIN+$01AA
  1149 268E A9 AA		 LDA< CODEORIGIN+$01AA
  1149 2690 20 27 23		 JSR @PRINTSTRING
  1150 2693 20 19 23			@printEOL
  1151
  1152 				; optimize FAIL ('@print', dli_vbl.pas), line = 143
  1153
  1154 					@printSTRING #CODEORIGIN+$01CC
  1154 				 LDY> CODEORIGIN+$01CC\ LDA< CODEORIGIN+$01CC\ JSR @PRINTSTRING
  1154 2696 A0 21		 LDY> CODEORIGIN+$01CC
  1154 2698 A9 CC		 LDA< CODEORIGIN+$01CC
  1154 269A 20 27 23		 JSR @PRINTSTRING
  1155 269D 20 19 23			@printEOL
  1156
  1157 				; optimize OK (dli_vbl.pas), line = 146
  1158
  1159 26A0 A9 00			lda #$00
  1160 26A2 85 58			sta $0058
  1161 26A4 A9 90			lda #$90
  1162 26A6 85 59			sta $0058+1
  1163
  1164 				; optimize OK (dli_vbl.pas), line = 149
  1165
  1166 26A8 A9 02			lda #$02
  1167 26AA 85 55			sta $0055
  1168 26AC A9 00			lda #$00
  1169 26AE 85 56			sta $0055+1
  1170
  1171 				; optimize OK (dli_vbl.pas), line = 150
  1172
  1173 26B0 85 54			sta $0054
  1174
  1175 				; optimize FAIL ('@print', dli_vbl.pas), line = 153
  1176
  1177 					@printSTRING #CODEORIGIN+$01E0
  1177 				 LDY> CODEORIGIN+$01E0\ LDA< CODEORIGIN+$01E0\ JSR @PRINTSTRING
  1177 26B2 A0 21		 LDY> CODEORIGIN+$01E0
  1177 26B4 A9 E0		 LDA< CODEORIGIN+$01E0
  1177 26B6 20 27 23		 JSR @PRINTSTRING
  1178
  1179 				; optimize FAIL ('@print', dli_vbl.pas), line = 154
  1180
  1181 					@printSTRING #CODEORIGIN+$01F6
  1181 				 LDY> CODEORIGIN+$01F6\ LDA< CODEORIGIN+$01F6\ JSR @PRINTSTRING
  1181 26B9 A0 21		 LDY> CODEORIGIN+$01F6
  1181 26BB A9 F6		 LDA< CODEORIGIN+$01F6
  1181 26BD 20 27 23		 JSR @PRINTSTRING
  1182
  1183 				; optimize FAIL ('@print', dli_vbl.pas), line = 155
  1184
  1185 					@printSTRING #CODEORIGIN+$020A
  1185 				 LDY> CODEORIGIN+$020A\ LDA< CODEORIGIN+$020A\ JSR @PRINTSTRING
  1185 26C0 A0 22		 LDY> CODEORIGIN+$020A
  1185 26C2 A9 0A		 LDA< CODEORIGIN+$020A
  1185 26C4 20 27 23		 JSR @PRINTSTRING
  1186
  1187 				; optimize FAIL ('@print', dli_vbl.pas), line = 156
  1188
  1189 					@printSTRING #CODEORIGIN+$01F6
  1189 				 LDY> CODEORIGIN+$01F6\ LDA< CODEORIGIN+$01F6\ JSR @PRINTSTRING
  1189 26C7 A0 21		 LDY> CODEORIGIN+$01F6
  1189 26C9 A9 F6		 LDA< CODEORIGIN+$01F6
  1189 26CB 20 27 23		 JSR @PRINTSTRING
  1190
  1191 				; optimize FAIL ('@print', dli_vbl.pas), line = 157
  1192
  1193 					@printSTRING #CODEORIGIN+$01F6
  1193 				 LDY> CODEORIGIN+$01F6\ LDA< CODEORIGIN+$01F6\ JSR @PRINTSTRING
  1193 26CE A0 21		 LDY> CODEORIGIN+$01F6
  1193 26D0 A9 F6		 LDA< CODEORIGIN+$01F6
  1193 26D2 20 27 23		 JSR @PRINTSTRING
  1194
  1195 				; optimize OK (dli_vbl.pas), line = 160
  1196
  1197 26D5 A9 00			lda #$00
  1198 26D7 85 58			sta $0058
  1199 26D9 A9 84			lda #$84
  1200 26DB 85 59			sta $0058+1
  1201
  1202 				; optimize OK (dli_vbl.pas), line = 161
  1203
  1204 26DD A9 02			lda #$02
  1205 26DF 85 55			sta $0055
  1206 26E1 A9 00			lda #$00
  1207 26E3 85 56			sta $0055+1
  1208
  1209 				; optimize OK (dli_vbl.pas), line = 162
  1210
  1211 26E5 85 54			sta $0054
  1212
  1213 				; optimize FAIL ('@print', dli_vbl.pas), line = 164
  1214
  1215 					@printSTRING #CODEORIGIN+$0220
  1215 				 LDY> CODEORIGIN+$0220\ LDA< CODEORIGIN+$0220\ JSR @PRINTSTRING
  1215 26E7 A0 22		 LDY> CODEORIGIN+$0220
  1215 26E9 A9 20		 LDA< CODEORIGIN+$0220
  1215 26EB 20 27 23		 JSR @PRINTSTRING
  1216 26EE 20 19 23			@printEOL
  1217
  1218 				; optimize FAIL ('@print', dli_vbl.pas), line = 165
  1219
  1220 					@printSTRING #CODEORIGIN+$0246
  1220 				 LDY> CODEORIGIN+$0246\ LDA< CODEORIGIN+$0246\ JSR @PRINTSTRING
  1220 26F1 A0 22		 LDY> CODEORIGIN+$0246
  1220 26F3 A9 46		 LDA< CODEORIGIN+$0246
  1220 26F5 20 27 23		 JSR @PRINTSTRING
  1221 26F8 20 19 23			@printEOL
  1222
  1223 				; optimize FAIL ('@print', dli_vbl.pas), line = 166
  1224
  1225 					@printSTRING #CODEORIGIN+$0266
  1225 				 LDY> CODEORIGIN+$0266\ LDA< CODEORIGIN+$0266\ JSR @PRINTSTRING
  1225 26FB A0 22		 LDY> CODEORIGIN+$0266
  1225 26FD A9 66		 LDA< CODEORIGIN+$0266
  1225 26FF 20 27 23		 JSR @PRINTSTRING
  1226 2702 20 19 23			@printEOL
  1227
  1228 				; optimize FAIL ('@print', dli_vbl.pas), line = 167
  1229
  1230 					@printSTRING #CODEORIGIN+$0286
  1230 				 LDY> CODEORIGIN+$0286\ LDA< CODEORIGIN+$0286\ JSR @PRINTSTRING
  1230 2705 A0 22		 LDY> CODEORIGIN+$0286
  1230 2707 A9 86		 LDA< CODEORIGIN+$0286
  1230 2709 20 27 23		 JSR @PRINTSTRING
  1231 270C 20 19 23			@printEOL
  1232
  1233 				; --- RepeatUntilProlog
  1234 270F			l_03DA
  1235
  1236 				; optimize FAIL ('CRT.KEYPRESSED', dli_vbl.pas), line = 171
  1237
  1238 270F 20 D3 23			jsr CRT.KEYPRESSED
  1239 2712 CA				dex
  1240 2713 B5 99			lda :STACKORIGIN+1,x
  1241 2715 F0 F8			jeq l_03DA
  1242
  1243 				; ------------------------------------------------------------
  1244
  1245 = 22AC			adr.DL	= CODEORIGIN+$02AC
  1246 2717			.var DL	= adr.DL .word
  1247 = 22CE			adr.DL2	= CODEORIGIN+$02CE
  1248 2717			.var DL2	= adr.DL2 .word
  1249 = A000			RMT_PLAYER	= $A000
  1250 = 4000			RMT_MODUL	= $4000
  1251 = 275B			adr.MSX	= [DATAORIGIN+$0027] .array [7]
  1252 2717			.var MSX	= adr.MSX .word
  1253 = 275B			MSX.PLAYER	= DATAORIGIN+$0027
  1254 = 275D			MSX.MODUL	= DATAORIGIN+$0029
  1255 = 275F			OLD_DLI	= DATAORIGIN+$002B
  1256 = 2761			OLD_VBL	= DATAORIGIN+$002D
  1257 2717			@exit
  1258
  1259 2717 A2 00		@halt	ldx #$00
  1260 2719 9A				txs
  1261 					.ifdef MAIN.@DEFINES.ROMOFF
  1262 					inc portb
  1263 					.endif
  1264
  1265 271A A0 01			ldy #$01
  1266
  1267 271C 60				rts
  1268
  1269 				; ------------------------------------------------------------
  1270
  1271 271D 00 00 00 00 00 00 + IOCB@COPY	:16 brk
  1272
  1273 				; ------------------------------------------------------------
  1274
  1275 272D			.local	@DEFINES
  1276 272D			ATARI
  1277 				.endl
  1278
  1279 272D			.local	@RESOURCE
  1280 				.endl
  1281
  1282 = 272D AC 22		DL
  1282 = 272F CE 22		DL2
  1282 = 2731 5B 27		MSX
  1282 				.endl							; MAIN
  1283
  1284 				; ------------------------------------------------------------
  1285 				; ------------------------------------------------------------
  1286
  1287 				.macro	UNITINITIALIZATION
  1288 				
  1289 					.ifdef MAIN.SYSTEM.@UnitInit
  1290 					jsr MAIN.SYSTEM.@UnitInit
  1291 					eif
  1292 				
  1293 					.ifdef MAIN.ATARI.@UnitInit
  1294 					jsr MAIN.ATARI.@UnitInit
  1295 					eif
  1296 				
  1297 					.ifdef MAIN.CRT.@UnitInit
  1298 					jsr MAIN.CRT.@UnitInit
  1299 					eif
  1300 				
  1301 					.ifdef MAIN.MISC.@UnitInit
  1302 					jsr MAIN.MISC.@UnitInit
  1303 					eif
  1304 				
  1305 					.ifdef MAIN.RMT.@UnitInit
  1306 					jsr MAIN.RMT.@UnitInit
  1307 					eif
  1308 				.endm
  1309
  1310 				; ------------------------------------------------------------
  1311
  1312 					ift .SIZEOF(MAIN.SYSTEM) > 0
  1313 					.print 'SYSTEM: ',MAIN.SYSTEM,'..',MAIN.SYSTEM+.SIZEOF(MAIN.SYSTEM)-1
  1313 				SYSTEM: $2389..$23BF
  1314 					eif
  1315
  1316 					ift .SIZEOF(MAIN.ATARI) > 0
  1317 					.print 'ATARI: ',MAIN.ATARI,'..',MAIN.ATARI+.SIZEOF(MAIN.ATARI)-1
  1318 					eif
  1319
  1320 					ift .SIZEOF(MAIN.CRT) > 0
  1321 					.print 'CRT: ',MAIN.CRT,'..',MAIN.CRT+.SIZEOF(MAIN.CRT)-1
  1321 				CRT: $23C0..$23E6
  1322 					eif
  1323
  1324 					ift .SIZEOF(MAIN.MISC) > 0
  1325 					.print 'MISC: ',MAIN.MISC,'..',MAIN.MISC+.SIZEOF(MAIN.MISC)-1
  1325 				MISC: $23E7..$2416
  1326 					eif
  1327
  1328 					ift .SIZEOF(MAIN.RMT) > 0
  1329 					.print 'RMT: ',MAIN.RMT,'..',MAIN.RMT+.SIZEOF(MAIN.RMT)-1
  1329 				RMT: $2417..$24F2
  1330 					eif
  1331
  1332 					.print 'CODE: ',CODEORIGIN,'..',MAIN.@RESOURCE-1
  1332 				CODE: $2000..$272C
  1333
  1334 				; ------------------------------------------------------------
  1335
  1336 2733				.align $0004
  1337
  1338 2734			DATAORIGIN
  1339 2734-2739> 28 00 18 00 + .by  $28 $00 $18 $00 $2D $0C
  1340
  1341 = 0006			VARINITSIZE	= *-DATAORIGIN
  1342 = 002F			VARDATASIZE	= 47
  1343
  1344 = 2763			PROGRAMSTACK	= DATAORIGIN+VARDATASIZE
  1345
  1346 					.print 'DATA: ',DATAORIGIN,'..',PROGRAMSTACK
  1346 				DATA: $2734..$2763
  1347
  1348 02E0-02E1> 56 23			run START
  1349
  1350 				; ------------------------------------------------------------
  1351
  1352 				.macro	STATICDATA
  1353 				.by  $23 $20 $20 $20 $52 $4D $54 $2D  $44 $4C $2D $56 $42 $4C $2D $44  $4C $49 $20 $77 $69 $74 $68 $20
  1354 				.by  $4D $41 $44 $20 $50 $61 $73 $63  $61 $6C $20 $20 $00 $23 $4E $54  $53 $43 $20 $2F $20 $50 $41 $4C
  1355 				.by  $20 $64 $65 $74 $65 $63 $74 $20  $66 $6F $72 $20 $63 $6F $72 $72  $65 $63 $74 $20 $6D $75 $73 $69
  1356 				.by  $63 $00 $08 $70 $6C $61 $79 $62  $61 $63 $6B $00 $21 $59 $6F $75  $20 $63 $61 $6E $20 $70 $75 $74
  1357 				.by  $20 $74 $65 $78 $74 $20 $74 $6F  $20 $73 $63 $72 $65 $65 $6E $20  $73 $69 $6D $70 $6C $65 $00 $22
  1358 				.by  $77 $72 $69 $74 $65 $20 $2F $20  $77 $72 $69 $74 $65 $6C $6E $20  $63 $6F $6D $6D $61 $6E $64 $73
  1359 				.by  $20 $6F $66 $20 $50 $61 $73 $63  $61 $6C $00 $23 $2D $2D $2D $2D  $2D $2D $2D $2D $2D $2D $2D $70
  1360 				.by  $72 $65 $73 $73 $20 $61 $20 $6B  $65 $79 $20 $2D $2D $2D $2D $2D  $2D $2D $2D $2D $2D $2D $2D $00
  1361 				.by  $24 $30 $20 $2D $20 $20 $20 $20  $20 $20 $64 $69 $66 $66 $65 $72  $65 $6E $74 $20 $67 $66 $78 $20
  1362 				.by  $6D $6F $64 $65 $73 $20 $20 $20  $20 $20 $20 $20 $20 $00 $1F $31  $20 $2D $20 $74 $65 $6E $20 $6C
  1363 				.by  $69 $6E $65 $73 $20 $6F $66 $20  $67 $66 $78 $20 $30 $20 $61 $74  $20 $24 $38 $30 $30 $30 $00 $1E
  1364 				.by  $32 $20 $2D $20 $69 $6E $68 $65  $72 $69 $74 $20 $62 $79 $20 $73  $6F $6D $65 $20 $6C $69 $6E $65
  1365 				.by  $73 $20 $77 $69 $74 $68 $00 $21  $33 $20 $2D $20 $67 $66 $78 $20  $31 $20 $26 $20 $32 $20 $6F $6E
  1366 				.by  $20 $64 $69 $66 $66 $65 $72 $65  $6E $74 $20 $73 $63 $72 $65 $65  $6E $00 $0F $34 $20 $2D $20 $6D
  1367 				.by  $65 $6D $6F $72 $79 $20 $61 $72  $65 $61 $00 $10 $35 $20 $2D $20  $28 $24 $39 $30 $30 $30 $20 $68
  1368 				.by  $65 $72 $65 $29 $00 $19 $36 $20  $2D $20 $66 $69 $72 $73 $74 $20  $67 $66 $78 $30 $20 $77 $72 $69
  1369 				.by  $74 $65 $20 $74 $68 $65 $6E $00  $20 $37 $20 $2D $20 $63 $68 $61  $6E $67 $65 $20 $38 $38 $20 $74
  1370 				.by  $6F $20 $77 $72 $69 $74 $65 $20  $67 $66 $78 $20 $31 $20 $26 $20  $32 $00 $20 $38 $20 $2D $20 $74
  1371 				.by  $68 $65 $6E $20 $73 $61 $6D $65  $20 $66 $6F $72 $20 $77 $72 $69  $74 $69 $6E $67 $20 $67 $66 $78
  1372 				.by  $20 $31 $32 $00 $12 $39 $20 $2D  $20 $6E $65 $61 $74 $2C $20 $69  $73 $6E $74 $20 $69 $74 $3F $00
  1373 				.by  $14 $20 $20 $20 $48 $45 $72 $65  $20 $57 $65 $20 $47 $4F $20 $20  $20 $20 $20 $20 $20 $00 $12 $20
  1374 				.by  $20 $20 $48 $45 $72 $65 $20 $57  $65 $20 $47 $4F $20 $20 $20 $20  $20 $00 $14 $20 $21 $21 $48 $45
  1375 				.by  $72 $65 $20 $57 $65 $20 $47 $4F  $21 $21 $20 $20 $20 $20 $20 $00  $24 $2D $2D $2D $2D $2D $2D $2D
  1376 				.by  $2D $2D $2D $2D $2D $2D $2D $2D  $2D $2D $2D $2D $2D $2D $2D $2D  $2D $2D $2D $2D $2D $2D $2D $2D
  1377 				.by  $2D $2D $2D $2D $2D $00 $1E $20  $20 $20 $20 $20 $67 $66 $78 $20  $31 $32 $20 $69 $73 $20 $68 $61
  1378 				.by  $72 $64 $20 $74 $6F $20 $72 $65  $61 $64 $20 $3A $29 $00 $1E $20  $20 $20 $20 $20 $62 $65 $74 $74
  1379 				.by  $65 $72 $20 $75 $73 $65 $20 $61  $20 $73 $70 $65 $63 $69 $61 $6C  $20 $66 $6F $6E $74 $00 $24 $2D
  1380 				.by  $2D $2D $2D $2D $2D $2D $2D $2D  $2D $2D $2D $2D $4B $45 $59 $2D  $2D $45 $58 $49 $54 $53 $2D $2D
  1381 				.by  $2D $2D $2D $2D $2D $2D $2D $2D  $2D $2D $2D $00 $F0 $70 $70 $42  $40 $BC $40 $02 $02 $02 $02 $02
  1382 				.by  $02 $02 $02 $02 $02 $02 $02 $02  $02 $02 $02 $02 $02 $02 $02 $02  $02 $02 $02 $41 $AC $22 $70 $70
  1383 				.by  $70 $42 $00 $80 $70 $70 $70 $02  $02 $02 $02 $46 $00 $90 $06 $07  $06 $06 $42 $C8 $80 $02 $02 $02
  1384 				.by  $70 $44 $00 $84 $04 $04 $04 $70  $42 $68 $81 $41 $CE $22
  1385 				.endm
  1386
  1387 					end
